"use strict";(self.webpackChunkdefang_docs=self.webpackChunkdefang_docs||[]).push([[4673],{6978:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>i,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>l});var o=t(74848),s=t(28453);const a={title:"Estimating AWS Deployment Costs",description:"Defang enables you to estimate the cost of deploying and running your project before you even create a cloud account.",sidebar_position:280},i="Estimating AWS Deployment Costs",r={id:"tutorials/estimating-aws-deployment-costs",title:"Estimating AWS Deployment Costs",description:"Defang enables you to estimate the cost of deploying and running your project before you even create a cloud account.",source:"@site/docs/tutorials/estimating-aws-deployment-costs.md",sourceDirName:"tutorials",slug:"/tutorials/estimating-aws-deployment-costs",permalink:"/docs/tutorials/estimating-aws-deployment-costs",draft:!1,unlisted:!1,editUrl:"https://github.com/DefangLabs/defang-docs/tree/main/docs/tutorials/estimating-aws-deployment-costs.md",tags:[],version:"current",sidebarPosition:280,frontMatter:{title:"Estimating AWS Deployment Costs",description:"Defang enables you to estimate the cost of deploying and running your project before you even create a cloud account.",sidebar_position:280},sidebar:"docsSidebar",previous:{title:"Deploy Existing Containers",permalink:"/docs/tutorials/deploy-container-using-the-cli"},next:{title:"Estimating GCP Deployment Costs",permalink:"/docs/tutorials/estimating-gcp-deployment-costs"}},d={},l=[{value:"Clone the sample",id:"clone-the-sample",level:2},{value:"Open the compose file",id:"open-the-compose-file",level:2},{value:"Generate an estimate",id:"generate-an-estimate",level:2},{value:"Deploying your project",id:"deploying-your-project",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h1,{id:"estimating-aws-deployment-costs",children:"Estimating AWS Deployment Costs"}),"\n",(0,o.jsxs)(n.p,{children:["Defang enables you to estimate the cost of deploying and running your project without needing to create an account with your cloud provider. This tutorial will walk through estimating the costs of deploying the ",(0,o.jsx)(n.a,{href:"https://github.com/DefangLabs/samples/tree/main/samples/django-postgres",children:"django-postgres"})," to AWS."]}),"\n",(0,o.jsx)(n.h2,{id:"clone-the-sample",children:"Clone the sample"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"defang generate       # select `django-postgres` (or any other sample) from the list\ncd django-postgres    # or the name of your project's working directory\n"})}),"\n",(0,o.jsx)(n.h2,{id:"open-the-compose-file",children:"Open the compose file"}),"\n",(0,o.jsxs)(n.p,{children:["Let's take a quick look at the compose file. There are two services: ",(0,o.jsx)(n.code,{children:"db"})," and ",(0,o.jsx)(n.code,{children:"django"}),". Defang can generate a cost estimate of running the project described by this compose file in the cloud."]}),"\n",(0,o.jsxs)(n.p,{children:["Notice that each service has a ",(0,o.jsx)(n.a,{href:"/docs/concepts/compose#deploy",children:(0,o.jsx)(n.code,{children:"deploy.resources.reservations"})})," property which describes the service's resource requirements. These numbers will have a significant impact on the cost of running these services in the cloud. The estimation defang generates for you will be sensitive to these numbers."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:'services:\n  db:\n    restart: unless-stopped\n    image: postgres:16\n    x-defang-postgres: true\n    environment:\n      - POSTGRES_DB=django\n      - POSTGRES_USER=django\n      - POSTGRES_PASSWORD\n    ports:\n      - mode: host\n        target: 5432\n        published: 5432\n    healthcheck:\n      test: ["CMD", "python3", "-c", "import sys, urllib.request; urllib.request.urlopen(sys.argv[1]).read()", "http://localhost:8000/"]\n    deploy:\n      resources:\n        reservations:\n          cpus: \'0.5\'\n          memory: 256M\n\n  django:\n    restart: unless-stopped\n    build: ./app\n    ports:\n      - mode: ingress\n        target: 8000\n        published: 8000\n    environment:\n      - DB_HOST=db\n      - DEBUG=False\n      - POSTGRES_USER=django\n      - POSTGRES_DB=django\n      - POSTGRES_PASSWORD\n      - SECRET_KEY\n      - ALLOWED_HOSTS\n    depends_on:\n      - db\n    deploy:\n      resources:\n        reservations:\n          cpus: \'0.5\'\n          memory: 256M\n'})}),"\n",(0,o.jsx)(n.h2,{id:"generate-an-estimate",children:"Generate an estimate"}),"\n",(0,o.jsx)(n.p,{children:"Generating an estimate is easy. All you need to do is run"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"defang estimate\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Defang can deploy a project according to different ",(0,o.jsx)(n.a,{href:"/docs/concepts/deployment-modes",children:"deployment modes"}),". By default, defang will estimate the cost deploying with the ",(0,o.jsx)(n.code,{children:"affordable"})," mode. If you would like to increase your application's resiliency, you can deploy will the ",(0,o.jsx)(n.code,{children:"balanced"})," or ",(0,o.jsx)(n.code,{children:"high_availability"})," modes. Defang can estimate the cost of deploying using any of these modes."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"defang estimate --provider aws [--mode affordable|balanced|high_availability]\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Here is an example of the output you would see if you estimated the cost deploying the ",(0,o.jsx)(n.a,{href:"https://github.com/DefangLabs/samples/tree/main/samples/django-postgres",children:"django-postgres"})," sample using the ",(0,o.jsx)(n.code,{children:"balanced"})," ",(0,o.jsx)(n.a,{href:"/docs/concepts/deployment-modes",children:"deployment mode"}),"."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'defang estimate --provider=aws --mode=balanced\n * Packaging the project files for django at /Users/defang/samples/samples/django-postgres/app\n * Generating deployment preview\n * Preparing estimate\n\nEstimate for Deployment Mode: BALANCED\n\nThis mode strikes a balance between cost and availability. Your application\nwill be deployed with spot instances. Databases will be provisioned using\nresources optimized for production. Services in the "internal" network will\nbe deployed to a private subnet with a NAT gateway for outbound internet access.\n\nCost    Quantity           Service   Description\n$16.43  730 Hours          (shared)  AWSELB USW2-LoadBalancerUsage\n$32.85  730 Hours          (shared)  AmazonEC2 USW2-NatGateway-Hours\n$25.00  100 %Utilized/mo   db        AmazonRDS USW2-InstanceUsage:db.r5.large\n$1.62   14600 GB-Hours     django    AmazonECS USW2-Fargate-EphemeralStorage-GB-Hours (20 GB * 730 hours)\n$1.62   365 GB-Hours       django    AmazonECS USW2-Fargate-GB-Hours (0.50 GB * 730 hours)\n-$1.14  365 GB-Hours       django    AmazonECS USW2-Fargate-GB-Hours-SpotDiscount (Estimated @ 70%)\n$7.39   182.50 vCPU-Hours  django    AmazonECS USW2-Fargate-vCPU-Hours:perCPU (0.25 vCPU * 730 hours)\n-$5.17  182.50 vCPU-Hours  django    AmazonECS USW2-Fargate-vCPU-Hours:perCPU-SpotDiscount (Estimated @ 70%)\nEstimated Monthly Cost: $78.60 (+ usage)\n\nEstimate does not include taxes or Discount Programs.\nTo estimate other modes, use defang estimate --mode=affordable|balanced|high_availability\nFor help with warnings, check our FAQ at https://s.defang.io/warnings\n'})}),"\n",(0,o.jsx)(n.p,{children:"This estimate will include a line item for the most significant monthly costs associated with your deployment. Each line item will be associated with a compose service if possible. Some resources will be shared between multiple compose services."}),"\n",(0,o.jsx)(n.h2,{id:"deploying-your-project",children:"Deploying your project"}),"\n",(0,o.jsx)(n.p,{children:"Now that you have estimated the costs associated with your project. You are ready to deploy to AWS."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"defang compose up --provider aws --mode affordable|balanced|high_availability\n"})})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>r});var o=t(96540);const s={},a=o.createContext(s);function i(e){const n=o.useContext(a);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),o.createElement(a.Provider,{value:n},e.children)}}}]);