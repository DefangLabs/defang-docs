"use strict";(self.webpackChunkdefang_docs=self.webpackChunkdefang_docs||[]).push([[4009],{9085:(e,o,t)=>{t.r(o),t.d(o,{assets:()=>a,contentTitle:()=>s,default:()=>c,frontMatter:()=>r,metadata:()=>l,toc:()=>d});var n=t(4848),i=t(8453);const r={title:"Adding Custom 1-Click Deploy to Your App",sidebar_position:800,description:"Add a custom 1-Click Deploy link to deploy your own app."},s="Adding Custom 1-Click Deploy to Your App",l={id:"tutorials/adding-custom-one-click-deploy",title:"Adding Custom 1-Click Deploy to Your App",description:"Add a custom 1-Click Deploy link to deploy your own app.",source:"@site/docs/tutorials/adding-custom-one-click-deploy.md",sourceDirName:"tutorials",slug:"/tutorials/adding-custom-one-click-deploy",permalink:"/docs/tutorials/adding-custom-one-click-deploy",draft:!1,unlisted:!1,editUrl:"https://github.com/DefangLabs/defang-docs/tree/main/docs/tutorials/adding-custom-one-click-deploy.md",tags:[],version:"current",sidebarPosition:800,frontMatter:{title:"Adding Custom 1-Click Deploy to Your App",sidebar_position:800,description:"Add a custom 1-Click Deploy link to deploy your own app."},sidebar:"docsSidebar",previous:{title:"Using Codespaces and Gitpod",permalink:"/docs/tutorials/using-codespaces-gitpod"},next:{title:"Providers",permalink:"/docs/category/providers"}},a={},d=[{value:"How 1-Click Deploy Works",id:"how-1-click-deploy-works",level:3},{value:"Pre-requisites",id:"pre-requisites",level:2},{value:"Step 1 - Prepare Your App",id:"step-1---prepare-your-app",level:2},{value:"Step 2 - Copy the GitHub Workflow",id:"step-2---copy-the-github-workflow",level:2},{value:"Step 3 - Prepare Your Repository",id:"step-3---prepare-your-repository",level:2},{value:"Step 4 - Get the Encoded URL",id:"step-4---get-the-encoded-url",level:2},{value:"Step 5 - Create the 1-Click Deploy Link",id:"step-5---create-the-1-click-deploy-link",level:2},{value:"Step 6 - Use the Link",id:"step-6---use-the-link",level:2}];function p(e){const o={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.h1,{id:"adding-custom-1-click-deploy-to-your-app",children:"Adding Custom 1-Click Deploy to Your App"}),"\n",(0,n.jsx)(o.p,{children:"This tutorial will show you how to add a 1-Click Deploy link to deploy your app to the Defang Playground."}),"\n",(0,n.jsxs)(o.p,{children:["The link is often placed as a button in the ",(0,n.jsx)(o.code,{children:"README.md"})," file of your project repository, and is the easiest way to allow anyone to deploy your app."]}),"\n",(0,n.jsx)(o.admonition,{type:"info",children:(0,n.jsxs)(o.p,{children:["If you are trying to use 1-Click Deploy with one of our ",(0,n.jsx)(o.a,{href:"https://defang.io/samples/",children:"samples"}),", we have a separate tutorial on ",(0,n.jsx)(o.a,{href:"/docs/tutorials/using-one-click-deploy",children:"how to use 1-Click Deploy"}),"."]})}),"\n",(0,n.jsx)(o.h3,{id:"how-1-click-deploy-works",children:"How 1-Click Deploy Works"}),"\n",(0,n.jsx)(o.p,{children:"A 1-Click Deploy link points to a special URL. Clicking this link will prompt the user to create a new GitHub repo with a clone of your project. This new repo will contain a GitHub Actions workflow which will automatically deploy the project to Defang."}),"\n",(0,n.jsx)(o.h2,{id:"pre-requisites",children:"Pre-requisites"}),"\n",(0,n.jsxs)(o.ul,{children:["\n",(0,n.jsxs)(o.li,{children:["A ",(0,n.jsx)(o.a,{href:"https://github.com/",children:"GitHub"})," repository for your project"]}),"\n"]}),"\n",(0,n.jsx)(o.h2,{id:"step-1---prepare-your-app",children:"Step 1 - Prepare Your App"}),"\n",(0,n.jsxs)(o.p,{children:["You will need a ",(0,n.jsx)(o.code,{children:"compose.yaml"})," file in the root folder of your project repository to describe the services which will be deployed. Learn more about writing ",(0,n.jsx)(o.a,{href:"/docs/concepts/compose#example-of-a-compose-file",children:"Compose files"}),"."]}),"\n",(0,n.jsx)(o.h2,{id:"step-2---copy-the-github-workflow",children:"Step 2 - Copy the GitHub Workflow"}),"\n",(0,n.jsxs)(o.p,{children:["In your project, add a new folder named ",(0,n.jsx)(o.code,{children:".github"}),", then add a folder named ",(0,n.jsx)(o.code,{children:"workflows"})," inside it, and copy the entire GitHub Workflow ",(0,n.jsx)(o.code,{children:"deploy.yaml"})," file from ",(0,n.jsx)(o.a,{href:"https://github.com/DefangLabs/samples/blob/main/starter-sample/.github/workflows/deploy.yaml",children:"here"})," into the ",(0,n.jsx)(o.code,{children:"workflows"})," folder."]}),"\n",(0,n.jsxs)(o.p,{children:["If your app requires ",(0,n.jsx)(o.a,{href:"/docs/concepts/configuration",children:"configuration"})," (e.g. API keys, passwords, etc.), learn more about ",(0,n.jsx)(o.a,{href:"https://github.com/DefangLabs/defang-github-action?tab=readme-ov-file#managing-config-values",children:"managing config variables with the Defang GitHub Action"}),"."]}),"\n",(0,n.jsxs)(o.p,{children:["You should have a ",(0,n.jsx)(o.code,{children:".yaml"})," file similar to the one below:"]}),"\n",(0,n.jsx)(o.pre,{children:(0,n.jsx)(o.code,{className:"language-yaml",children:"name: Deploy\n\non:\n  push:\n    branches:\n      - main\n\njobs:\n  deploy:\n    environment: playground\n    runs-on: ubuntu-latest\n    permissions:\n      contents: read\n      id-token: write\n\n    steps:\n    - name: Checkout Repo\n      uses: actions/checkout@v4\n\n    - name: Deploy\n      uses: DefangLabs/defang-github-action@v1.1.3\n"})}),"\n",(0,n.jsx)(o.h2,{id:"step-3---prepare-your-repository",children:"Step 3 - Prepare Your Repository"}),"\n",(0,n.jsxs)(o.p,{children:["To support 1-Click Deploy, your repository must be a ",(0,n.jsx)(o.a,{href:"https://docs.github.com/en/repositories/creating-and-managing-repositories/creating-a-repository-from-a-template",children:"Template Repository"}),". In order to make your repository into a Template Repository, complete the following steps:"]}),"\n",(0,n.jsxs)(o.ol,{children:["\n",(0,n.jsx)(o.li,{children:'Go to the repository\'s "Settings" near the right on the top bar.'}),"\n",(0,n.jsx)(o.li,{children:'Select the "Template repository" box to turn your repo into a template repo, as seen below:'}),"\n"]}),"\n",(0,n.jsx)(o.p,{children:(0,n.jsx)(o.img,{alt:"select-template-repo-box",src:t(6393).A+"",width:"500",height:"250"})}),"\n",(0,n.jsxs)(o.ol,{start:"3",children:["\n",(0,n.jsx)(o.li,{children:"Go back to your repository's homepage."}),"\n",(0,n.jsx)(o.li,{children:'Click the dropdown menu next to the green "Use this template" button near the top right corner, then click "Create a new repository":'}),"\n"]}),"\n",(0,n.jsx)(o.p,{children:(0,n.jsx)(o.img,{alt:"use-this-template",src:t(1441).A+"",width:"400",height:"261"})}),"\n",(0,n.jsxs)(o.ol,{start:"5",children:["\n",(0,n.jsx)(o.li,{children:"You will be taken to a page similar to the one shown below."}),"\n"]}),"\n",(0,n.jsx)(o.p,{children:(0,n.jsx)(o.img,{alt:"create-repo",src:t(5121).A+"",width:"1368",height:"1178"})}),"\n",(0,n.jsx)(o.p,{children:"Now stay on this page and continue to the next step."}),"\n",(0,n.jsx)(o.h2,{id:"step-4---get-the-encoded-url",children:"Step 4 - Get the Encoded URL"}),"\n",(0,n.jsx)(o.p,{children:"You will need the encoded version of the URL of the page from the previous step. This will be used as a redirect for the 1-Click Deploy link."}),"\n",(0,n.jsxs)(o.ol,{children:["\n",(0,n.jsx)(o.li,{children:'Copy the URL of the page you are on ( "Create a new repository" page sourced from your template repository). It should look something like the following:'}),"\n"]}),"\n",(0,n.jsx)(o.pre,{children:(0,n.jsx)(o.code,{children:"https://github.com/new?template_name=<your-repo-name>&template_owner=<your-github-username>\n"})}),"\n",(0,n.jsxs)(o.ol,{start:"2",children:["\n",(0,n.jsx)(o.li,{children:"You can go online and paste the URL from the step above into a URL encoder tool of your choice. You should end up with an encoded URL, similar to the one shown below:"}),"\n"]}),"\n",(0,n.jsx)(o.pre,{children:(0,n.jsx)(o.code,{children:"https%3A%2F%2Fgithub.com%2Fnew%3Ftemplate_name%3D<your-repo-name>%26template_owner%3D<your-github-username>\n"})}),"\n",(0,n.jsx)(o.h2,{id:"step-5---create-the-1-click-deploy-link",children:"Step 5 - Create the 1-Click Deploy Link"}),"\n",(0,n.jsxs)(o.p,{children:["You will need to create a 1-Click Deploy link with the following format: ",(0,n.jsx)(o.code,{children:"https://portal.defang.dev/redirect?url="})," + your encoded URL. This ensures that the user can get ",(0,n.jsx)(o.a,{href:"/docs/concepts/authentication/",children:"logged in"})," to Defang before they get redirected to clone your app for deployment."]}),"\n",(0,n.jsx)(o.admonition,{type:"tip",children:(0,n.jsxs)(o.p,{children:["Optionally, you can add ",(0,n.jsx)(o.code,{children:"&name=<your-suggested-name>"})," to the end of the link if you'd like to suggest a name for the user to use for their deployment."]})}),"\n",(0,n.jsx)(o.p,{children:"The finished link should look similar to the one below:"}),"\n",(0,n.jsx)(o.pre,{children:(0,n.jsx)(o.code,{children:"https://portal.defang.dev/redirect?url=https%3A%2F%2Fgithub.com%2Fnew%3Ftemplate_name%3D<your-repo-name>%26template_owner%3D<your-github-username>&name=<your-suggested-name>\n"})}),"\n",(0,n.jsx)(o.p,{children:"Now you have a link for anyone to deploy your app to Defang, with just 1 click."}),"\n",(0,n.jsx)(o.h2,{id:"step-6---use-the-link",children:"Step 6 - Use the Link"}),"\n",(0,n.jsx)(o.p,{children:"For example, you can add it as a link in a Markdown file:"}),"\n",(0,n.jsx)(o.pre,{children:(0,n.jsx)(o.code,{children:"[1-Click Deploy Link](https://portal.defang.dev/redirect?url=<your-encoded-url>&name=<your-project-here>)\n"})}),"\n",(0,n.jsx)(o.p,{children:"Or perhaps you can add it to a button with your own styling:"}),"\n",(0,n.jsx)(o.pre,{children:(0,n.jsx)(o.code,{children:"[![1-click-deploy-button](https://defang.io/deploy-with-defang.png)](https://portal.defang.dev/redirect?url=<your-encoded-url>&name=<your-project-here>)\n"})})]})}function c(e={}){const{wrapper:o}={...(0,i.R)(),...e.components};return o?(0,n.jsx)(o,{...e,children:(0,n.jsx)(p,{...e})}):p(e)}},5121:(e,o,t)=>{t.d(o,{A:()=>n});const n=t.p+"assets/images/create-repo-2102ac208d52067569897fb5e9dff12e.png"},6393:(e,o,t)=>{t.d(o,{A:()=>n});const n=t.p+"assets/images/select-template-repo-box-34f6dee088348d2f156e786c936c7880.png"},1441:(e,o,t)=>{t.d(o,{A:()=>n});const n=t.p+"assets/images/use-this-template-92e5c7c792e72457500d1326dd01d66a.png"},8453:(e,o,t)=>{t.d(o,{R:()=>s,x:()=>l});var n=t(6540);const i={},r=n.createContext(i);function s(e){const o=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function l(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),n.createElement(r.Provider,{value:o},e.children)}}}]);