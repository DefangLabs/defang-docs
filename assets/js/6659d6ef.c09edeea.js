"use strict";(self.webpackChunkdefang_docs=self.webpackChunkdefang_docs||[]).push([[4914],{4932:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>t,default:()=>u,frontMatter:()=>r,metadata:()=>c,toc:()=>d});var o=i(4848),s=i(8453);const r={sidebar_position:250,title:"How it Works",description:"Overview of the Defang architecture and how it works in your cloud"},t="How Defang Works",c={id:"intro/how-it-works",title:"How it Works",description:"Overview of the Defang architecture and how it works in your cloud",source:"@site/docs/intro/how-it-works.mdx",sourceDirName:"intro",slug:"/intro/how-it-works",permalink:"/docs/intro/how-it-works",draft:!1,unlisted:!1,editUrl:"https://github.com/DefangLabs/defang-docs/tree/main/docs/intro/how-it-works.mdx",tags:[],version:"current",sidebarPosition:250,frontMatter:{sidebar_position:250,title:"How it Works",description:"Overview of the Defang architecture and how it works in your cloud"},sidebar:"docsSidebar",previous:{title:"Features",permalink:"/docs/intro/features"},next:{title:"Use Cases",permalink:"/docs/intro/use-cases"}},a={},d=[{value:"Bootstrapping",id:"bootstrapping",level:2},{value:"Orchestrating Deployments",id:"orchestrating-deployments",level:2},{value:"Building Images",id:"building-images",level:2},{value:"Service Provisioning",id:"service-provisioning",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h1,{id:"how-defang-works",children:"How Defang Works"}),"\n",(0,o.jsxs)(n.p,{children:['Defang is an AI-assisted tool that lets you take your app from Docker Compose to a secure and scalable deployment on your favorite cloud in minutes. Defang abstracts away the complexity of cloud infrastructure, providing you with a streamlined experience. Defang works by provisioning a "CD" service and a small set of resources in your cloud account. These services enable Defang to orchestrate deployments for you in your cloud account from the ',(0,o.jsx)(n.code,{children:"defang"})," CLI. Here's how it works."]}),"\n",(0,o.jsx)(n.h2,{id:"bootstrapping",children:"Bootstrapping"}),"\n",(0,o.jsxs)(n.p,{children:["The first time you deploy with Defang, a new ",(0,o.jsx)(n.code,{children:"CD"})," service will be created in your cloud account. This service acts as an intermediary between you and your cloud provider. It will set up a grpc endpoint with which the ",(0,o.jsx)(n.code,{children:"defang"})," CLI can communicate. When the CLI sends a request to trigger a deployment, for example, this service will orchestrate the build and deployment process\u2014interfacing with the cloud APIs on your behalf. We will also create the necessary resources to support the Defang system. This includes things like roles, a storage space, an image repository, certificates, etc. The specific resources created depend on the cloud provider."]}),"\n",(0,o.jsxs)(n.p,{children:["Our architecture and AWS implementation has passed a ",(0,o.jsx)(n.a,{href:"https://docs.aws.amazon.com/wellarchitected/latest/framework/welcome.html",children:'"well-architected"'})," review. We are in the process for obtaining similar qualifications with Digital Ocean and Google Cloud."]}),"\n",(0,o.jsxs)(n.p,{children:["You can learn more about the specifics by visiting our ",(0,o.jsx)(n.a,{href:"/docs/category/providers",children:"provider docs"}),"."]}),"\n",(0,o.jsx)(n.admonition,{type:"info",children:(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"CD"})," service does not run all the time. It is only used when you deploy a new service or update an existing service. Once it has finished deploying your service, it will shut itself down."]})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-mermaid",children:'\nflowchart TD\n  subgraph workspace["Local Workspace"]\n    compose[compose.yaml]\n    CLI("Defang CLI")\n  end\n\n  subgraph cloud["Cloud"]\n    sdk(("SDK"))\n    CD(CD)\n    kaniko(Kaniko)\n\n    subgraph services[" "]\n      service1("Service 1")\n      service2("Service 2")\n      service3("Service 3")\n    end\n  end\n\ncompose --\x3e CLI\n\nCLI <--\x3e CD\nCD --\x3e kaniko\nCD --\x3e sdk\nsdk --\x3e services\n\n'})}),"\n",(0,o.jsx)(n.h2,{id:"orchestrating-deployments",children:"Orchestrating Deployments"}),"\n",(0,o.jsxs)(n.p,{children:["The Defang ",(0,o.jsx)(n.code,{children:"CD"})," service acts as an intermediary between you and your cloud provider. This service receives deployment requests from the ",(0,o.jsx)(n.code,{children:"defang"})," CLI. Once a request has been received, ",(0,o.jsx)(n.code,{children:"CD"})," orchestrates the process of building application images from your source code, and then continues to provision the necessary resources to deploy your application."]}),"\n",(0,o.jsx)(n.admonition,{type:"info",children:(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"defang"})," CLI will upload your source code to a storage destination within your cloud. Your source code is never processed by Defang's servers."]})}),"\n",(0,o.jsx)(n.h2,{id:"building-images",children:"Building Images"}),"\n",(0,o.jsxs)(n.p,{children:["When you deploy a new service, Defang will build a Docker image from your source code. This source code is uploaded by the ",(0,o.jsx)(n.code,{children:"defang"})," CLI to a storage destination in your cloud account. The Defang ",(0,o.jsx)(n.code,{children:"CD"})," service will then retrieve it and determine if each of your service's images need to be rebuilt. If rebuilding is necessary, ",(0,o.jsx)(n.code,{children:"CD"})," will start a new container for each build it needs to complete."]}),"\n",(0,o.jsxs)(n.p,{children:["When you deploy an update to an existing service, the Defang ",(0,o.jsx)(n.code,{children:"CD"})," service will determine if rebuilding your service's images is necessary. For example, when deploying new source code, ",(0,o.jsx)(n.code,{children:"CD"})," will request that a new image be built. When deploying an update which does not require a new image, one will not be built\u2014for example, redeploying the same service with increased or decreased resource requirements. In this case, the same image can be deployed to newly provisioned cloud resources."]}),"\n",(0,o.jsxs)(n.p,{children:["Defang uses ",(0,o.jsx)(n.a,{href:"https://github.com/GoogleContainerTools/kaniko",children:"Kaniko"})," to build your images in a container in your cloud account. The resulting images will be stored in your cloud account's private container registry for future reference."]}),"\n",(0,o.jsx)(n.h2,{id:"service-provisioning",children:"Service Provisioning"}),"\n",(0,o.jsxs)(n.p,{children:["After your images have been built, ",(0,o.jsx)(n.code,{children:"CD"})," will provision the necessary resources and deploy these images as new services in your cloud account. Defang uses the cloud provider's SDK to create the necessary resources for your services. This may include creating new containers, setting up networking, and configuring any other resources your services needs, such as storage resources."]}),"\n",(0,o.jsxs)(n.p,{children:["When deploying changes to existing services, the ",(0,o.jsx)(n.code,{children:"CD"})," service will determine the minimum set of changes necessary and add, remove, replace, or update services as necessary."]})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>c});var o=i(6540);const s={},r=o.createContext(s);function t(e){const n=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),o.createElement(r.Provider,{value:n},e.children)}}}]);