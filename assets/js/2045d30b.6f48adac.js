"use strict";(self.webpackChunkdefang_docs=self.webpackChunkdefang_docs||[]).push([[4233],{28453:(e,i,n)=>{n.d(i,{R:()=>a,x:()=>l});var t=n(96540);const r={},s=t.createContext(r);function a(e){const i=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function l(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(s.Provider,{value:i},e.children)}},96432:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>o,contentTitle:()=>l,default:()=>p,frontMatter:()=>a,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"concepts/railpack","title":"Railpack","description":"Defang will use Railpack to make an OCI-Compliant container image for your project.","source":"@site/docs/concepts/railpack.md","sourceDirName":"concepts","slug":"/concepts/railpack","permalink":"/docs/concepts/railpack","draft":false,"unlisted":false,"editUrl":"https://github.com/DefangLabs/defang-docs/tree/main/docs/concepts/railpack.md","tags":[],"version":"current","frontMatter":{"title":"Railpack","description":"Defang will use Railpack to make an OCI-Compliant container image for your project."},"sidebar":"conceptsSidebar","previous":{"title":"Pulumi","permalink":"/docs/concepts/pulumi"},"next":{"title":"Resources","permalink":"/docs/concepts/resources"}}');var r=n(74848),s=n(28453);const a={title:"Railpack",description:"Defang will use Railpack to make an OCI-Compliant container image for your project."},l="Railpack",o={},c=[{value:"How to trigger a Defang Railpack deployment",id:"how-to-trigger-a-defang-railpack-deployment",level:2},{value:"Troubleshooting and tips",id:"troubleshooting-and-tips",level:2},{value:"Railpack Detection",id:"railpack-detection",level:3},{value:"Node",id:"node",level:4},{value:"Python",id:"python",level:4},{value:"Go",id:"go",level:4},{value:"PHP",id:"php",level:4},{value:"Java",id:"java",level:4},{value:"Ruby",id:"ruby",level:4},{value:"Rust",id:"rust",level:4},{value:"Elixir",id:"elixir",level:4},{value:"Static Sites",id:"static-sites",level:4},{value:"Supported Providers",id:"supported-providers",level:2}];function d(e){const i={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.header,{children:(0,r.jsx)(i.h1,{id:"railpack",children:"Railpack"})}),"\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.a,{href:"https://railpack.com/",children:"Railpack"})," is a tool for building container images from source code with minimal configuration. It is the successor to ",(0,r.jsx)(i.a,{href:"https://nixpacks.com/",children:"Nixpacks"})," and incorporates several lessons learned from running Nixpacks in production at ",(0,r.jsx)(i.a,{href:"https://railway.com/",children:"Railway"})," over the years."]}),"\n",(0,r.jsx)(i.p,{children:"In Defang deployments, one of the most common issues faced by users is a missing or invalid Dockerfile that can\u2019t produce OCI-compliant images. This is especially common when Dockerfile are generated by LLMs or created by users with limited Docker experience. Since integrating Railpack into Defang, if no Dockerfile is provided, we now automatically build a working image for you using Railpack."}),"\n",(0,r.jsx)(i.h2,{id:"how-to-trigger-a-defang-railpack-deployment",children:"How to trigger a Defang Railpack deployment"}),"\n",(0,r.jsx)(i.p,{children:"When you run a Defang Railpack deployment, you need 2 components:"}),"\n",(0,r.jsxs)(i.ol,{children:["\n",(0,r.jsx)(i.li,{children:"A working application"}),"\n",(0,r.jsx)(i.li,{children:"A valid Compose file"}),"\n"]}),"\n",(0,r.jsx)(i.p,{children:"Your Compose file should not mention a Dockerfile."}),"\n",(0,r.jsx)(i.p,{children:"For example,"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-yaml",children:'services:\n  app:\n    restart: unless-stopped\n    build:\n      context: .\n    deploy:\n      resources:\n        reservations:\n          cpus: "1.0"\n          memory: 512M\n    ports:\n      - mode: ingress\n        target: 3000\n        published: 3000\n'})}),"\n",(0,r.jsx)(i.h2,{id:"troubleshooting-and-tips",children:"Troubleshooting and tips"}),"\n",(0,r.jsx)(i.p,{children:"If the deployment fails, here are some things you can try."}),"\n",(0,r.jsx)(i.h3,{id:"railpack-detection",children:"Railpack Detection"}),"\n",(0,r.jsx)(i.p,{children:"To allow Railpack to generate a build plan for your project, please restructure or rename your existing project files to be Railpack-compatible, as described for each framework below."}),"\n",(0,r.jsx)(i.h4,{id:"node",children:(0,r.jsx)(i.a,{href:"https://railpack.com/languages/node/",children:"Node"})}),"\n",(0,r.jsxs)(i.p,{children:["Your project will be detected as a Node.js application if a ",(0,r.jsx)(i.code,{children:"package.json"})," file exists in the root directory."]}),"\n",(0,r.jsx)(i.p,{children:"Here is an example of:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:["A Railpack-ready ",(0,r.jsx)(i.a,{href:"https://github.com/DefangLabs/samples/tree/main/samples/react-vite-railpack",children:"React Vite project"})]}),"\n",(0,r.jsxs)(i.li,{children:["A Railpack-ready ",(0,r.jsx)(i.a,{href:"https://github.com/DefangLabs/samples/tree/main/samples/nextjs-railpack",children:"NextJS project"})]}),"\n"]}),"\n",(0,r.jsx)(i.h4,{id:"python",children:(0,r.jsx)(i.a,{href:"https://railpack.com/languages/python",children:"Python"})}),"\n",(0,r.jsx)(i.p,{children:"Your project will be detected as a Python application if any of these conditions are met:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"A main.py file exists in the root directory (If your main.py is named anything else)"}),"\n",(0,r.jsx)(i.li,{children:"A requirements.txt file exists"}),"\n",(0,r.jsx)(i.li,{children:"A pyproject.toml file exists"}),"\n",(0,r.jsx)(i.li,{children:"A Pipfile exists"}),"\n"]}),"\n",(0,r.jsx)(i.p,{children:"Here is an example of:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:["A Railpack-ready ",(0,r.jsx)(i.a,{href:"https://github.com/DefangLabs/samples/tree/main/samples/django-railpack",children:"Django project"})]}),"\n",(0,r.jsxs)(i.li,{children:["A Railpack-ready ",(0,r.jsx)(i.a,{href:"https://github.com/DefangLabs/samples/tree/main/samples/flask-railpack",children:"Flask project"})]}),"\n"]}),"\n",(0,r.jsx)(i.h4,{id:"go",children:(0,r.jsx)(i.a,{href:"https://railpack.com/languages/golang",children:"Go"})}),"\n",(0,r.jsx)(i.p,{children:"Your project will be detected as a Go application if any of these conditions are met:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"A go.mod file exists in the root directory"}),"\n",(0,r.jsx)(i.li,{children:"A go.work file exists in the root directory (Go workspaces)"}),"\n",(0,r.jsx)(i.li,{children:"A main.go file exists in the root directory"}),"\n"]}),"\n",(0,r.jsx)(i.p,{children:"Here is an example of:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:["A Railpack-ready ",(0,r.jsx)(i.a,{href:"https://github.com/DefangLabs/samples/tree/main/samples/golang-http-form-railpack",children:"Golang project"})]}),"\n"]}),"\n",(0,r.jsx)(i.h4,{id:"php",children:(0,r.jsx)(i.a,{href:"https://railpack.com/languages/php",children:"PHP"})}),"\n",(0,r.jsx)(i.p,{children:"Your project will be detected as a PHP application if any of these conditions are met:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"An index.php file exists in the root directory"}),"\n",(0,r.jsx)(i.li,{children:"A composer.json file exists in the root directory"}),"\n"]}),"\n",(0,r.jsx)(i.h4,{id:"java",children:(0,r.jsx)(i.a,{href:"https://railpack.com/languages/java",children:"Java"})}),"\n",(0,r.jsx)(i.p,{children:"Your project will be detected as a Java application if any of these conditions are met:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"A gradlew (Gradle wrapper) file exists in the root directory (to create this, if you don\u2019t have one, run gradle wrapper)"}),"\n",(0,r.jsxs)(i.li,{children:["A ",(0,r.jsx)(i.code,{children:"pom.{xml,atom,clj,groovy,rb,scala,yaml,yml}"})," file exists in the root directory"]}),"\n"]}),"\n",(0,r.jsx)(i.h4,{id:"ruby",children:(0,r.jsx)(i.a,{href:"https://railpack.com/languages/ruby",children:"Ruby"})}),"\n",(0,r.jsx)(i.p,{children:"Your project will be detected as a Ruby application if any of these conditions are met:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"A Gemfile file is present"}),"\n"]}),"\n",(0,r.jsx)(i.h4,{id:"rust",children:(0,r.jsx)(i.a,{href:"https://railpack.com/languages/rust",children:"Rust"})}),"\n",(0,r.jsx)(i.p,{children:"Your project will be detected as a Rust application if any of these conditions are met:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"A Cargo.toml file is present"}),"\n"]}),"\n",(0,r.jsx)(i.h4,{id:"elixir",children:(0,r.jsx)(i.a,{href:"https://railpack.com/languages/elixir",children:"Elixir"})}),"\n",(0,r.jsx)(i.p,{children:"Your project will be detected as a Elixir application if any of these conditions are met:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"A mix.exs file exists in the root directory"}),"\n"]}),"\n",(0,r.jsx)(i.h4,{id:"static-sites",children:(0,r.jsx)(i.a,{href:"https://railpack.com/languages/staticfile",children:"Static Sites"})}),"\n",(0,r.jsxs)(i.p,{children:["Railpack can automatically build and setup a server for static sites that require no build steps. The ",(0,r.jsx)(i.a,{href:"https://caddyserver.com/",children:"Caddy"})," server is used as the underlying web server."]}),"\n",(0,r.jsx)(i.p,{children:"Your project will be automatically detected as a static site if any of these conditions are met:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"A Staticfile configuration file exists in the root directory"}),"\n",(0,r.jsx)(i.li,{children:"An index.html file exists in the root directory"}),"\n",(0,r.jsx)(i.li,{children:"A public directory exists"}),"\n",(0,r.jsxs)(i.li,{children:["The ",(0,r.jsx)(i.code,{children:"RAILPACK_STATIC_FILE_ROOT"})," environment variable is set"]}),"\n"]}),"\n",(0,r.jsxs)(i.p,{children:["Static sites are served using the\xa0Caddy\xa0web server\xa0and you need to have the environment variable ",(0,r.jsx)(i.code,{children:"PORT"})," exposed like this in the Compose file to map to the correct port:"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{children:'services:\n  app:\n    restart: "unless-stopped"\n    build:\n      context: ./app\n    # This is the port you need to add\n    environment:\n      PORT: 5173 # <--- PORT\n    ports:\n      - target: 5173\n        published: 5173\n        mode: ingress\n    deploy:\n      resources:\n        reservations:\n          memory: 512M\n'})}),"\n",(0,r.jsx)(i.h2,{id:"supported-providers",children:"Supported Providers"}),"\n",(0,r.jsxs)(i.table,{children:[(0,r.jsx)(i.thead,{children:(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.th,{children:"Provider"}),(0,r.jsx)(i.th,{style:{textAlign:"center"},children:"Railpack Support"})]})}),(0,r.jsxs)(i.tbody,{children:[(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Playground"}),(0,r.jsx)(i.td,{style:{textAlign:"center"},children:"\u2705"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"AWS"}),(0,r.jsx)(i.td,{style:{textAlign:"center"},children:"\u2705"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"DigitalOcean"}),(0,r.jsx)(i.td,{style:{textAlign:"center"},children:"\u274c"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"GCP"}),(0,r.jsx)(i.td,{style:{textAlign:"center"},children:"\u2705"})]})]})]})]})}function p(e={}){const{wrapper:i}={...(0,s.R)(),...e.components};return i?(0,r.jsx)(i,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);