"use strict";(self.webpackChunkdefang_docs=self.webpackChunkdefang_docs||[]).push([[3002],{28453:(e,s,r)=>{r.d(s,{R:()=>i,x:()=>t});var n=r(96540);const c={},o=n.createContext(c);function i(e){const s=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function t(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:i(e.components),n.createElement(o.Provider,{value:s},e.children)}},51211:(e,s,r)=>{r.r(s),r.d(s,{assets:()=>d,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>t,toc:()=>l});var n=r(74848),c=r(28453);const o={title:"Resources",description:"Customize the resources your Defang services use."},i="Run-time Resources",t={id:"concepts/resources",title:"Resources",description:"Customize the resources your Defang services use.",source:"@site/docs/concepts/resources.md",sourceDirName:"concepts",slug:"/concepts/resources",permalink:"/docs/concepts/resources",draft:!1,unlisted:!1,editUrl:"https://github.com/DefangLabs/defang-docs/tree/main/docs/concepts/resources.md",tags:[],version:"current",frontMatter:{title:"Resources",description:"Customize the resources your Defang services use."},sidebar:"docsSidebar",previous:{title:"Railpack",permalink:"/docs/concepts/railpack"},next:{title:"Scaling",permalink:"/docs/concepts/scaling"}},d={},l=[{value:"Examples",id:"examples",level:2},{value:"Docker Compose",id:"docker-compose",level:3},{value:"Pulumi",id:"pulumi",level:3}];function a(e){const s={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,c.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.h1,{id:"run-time-resources",children:"Run-time Resources"}),"\n",(0,n.jsx)(s.p,{children:"You can configure the resources available to your Defang services as required. You can configure the CPU, and memory allocated to your services as well as the number of replicas and whether or not your services requires access to GPUs."}),"\n",(0,n.jsx)(s.h2,{id:"examples",children:"Examples"}),"\n",(0,n.jsx)(s.h3,{id:"docker-compose",children:"Docker Compose"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-yaml",children:'services:\n  gpu-service:\n    deploy:\n      replicas: 3\n      resources:\n        reservations:\n          cpus: "1.0"\n          memory: 2048M\n          devices:\n            - capabilities: ["gpu"]\n'})}),"\n",(0,n.jsx)(s.h3,{id:"pulumi",children:"Pulumi"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-typescript",children:'const service = new defang.DefangService("gpu-service", {\n  deploy: {\n    replicas: 3,\n    resources: {\n      reservations: {\n        cpu: 1.0,\n        memory: 2048,\n        devices: [{ capabilities: ["gpu"] }],\n      },\n    },\n  },\n});\n'})}),"\n",(0,n.jsx)(s.admonition,{title:"GPUs",type:"info",children:(0,n.jsxs)(s.p,{children:["If you require access to GPUs, you can specify this in the ",(0,n.jsx)(s.code,{children:"deploy.resources.reservations.devices[0].capabilities"})," section of your service as in the examples above. You can learn more about this in the ",(0,n.jsx)(s.a,{href:"https://docs.docker.com/compose/gpu-support/",children:"Docker-Compose documentation"}),". This is the only supported value in the ",(0,n.jsx)(s.code,{children:"deploy.resources.reservations.devices"})," section."]})}),"\n",(0,n.jsx)(s.h1,{id:"build-time-resources",children:"Build-time Resources"}),"\n",(0,n.jsxs)(s.p,{children:["You can configure the memory requirements and disk space requirements for your image builds by using the ",(0,n.jsx)(s.code,{children:"shm_size"})," property of your service's ",(0,n.jsxs)(s.a,{href:"https://github.com/compose-spec/compose-spec/blob/main/build.md",children:[(0,n.jsx)(s.code,{children:"build"})," specification"]}),"."]}),"\n",(0,n.jsx)(s.p,{children:"For example,"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-yaml",children:"services:\n  my_service:\n    build:\n      context: .\n      dockerfile: Dockerfile\n      shm_size: 2G\n"})}),"\n",(0,n.jsx)(s.admonition,{type:"info",children:(0,n.jsxs)(s.p,{children:["Defang uses ",(0,n.jsx)(s.code,{children:"shm_size"})," to configure both the memory and disk space available to your build process."]})}),"\n",(0,n.jsxs)(s.p,{children:["The default ",(0,n.jsx)(s.code,{children:"shm_size"})," values for each platform are as follows. More or less may be specified."]}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Provider"}),(0,n.jsxs)(s.th,{children:[(0,n.jsx)(s.code,{children:"shm_size"})," Minimum"]})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"AWS"}),(0,n.jsx)(s.td,{children:"16G"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Digital Ocean"}),(0,n.jsx)(s.td,{children:"8G"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"GCP"}),(0,n.jsx)(s.td,{children:"16G"})]})]})]})]})}function u(e={}){const{wrapper:s}={...(0,c.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(a,{...e})}):a(e)}}}]);