"use strict";(self.webpackChunkdefang_docs=self.webpackChunkdefang_docs||[]).push([[3699],{7355:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>t,contentTitle:()=>l,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>d});var o=i(4848),s=i(8453);const a={title:"Deploying a Django App with Real-time Moderation Using Defang",author:"Defang Team",tags:["deployment","django","docker","compose"]},l="Deploying a Django App with Real-time Moderation Using Defang",r={permalink:"/blog/2025/04/10/easiest-way-to-deploy-django",source:"@site/blog/2025-04-10-easiest-way-to-deploy-django.md",title:"Deploying a Django App with Real-time Moderation Using Defang",description:"<iframe style={{",date:"2025-04-10T00:00:00.000Z",formattedDate:"April 10, 2025",tags:[{label:"deployment",permalink:"/blog/tags/deployment"},{label:"django",permalink:"/blog/tags/django"},{label:"docker",permalink:"/blog/tags/docker"},{label:"compose",permalink:"/blog/tags/compose"}],readingTime:3.63,hasTruncateMarker:!1,authors:[{name:"Defang Team"}],frontMatter:{title:"Deploying a Django App with Real-time Moderation Using Defang",author:"Defang Team",tags:["deployment","django","docker","compose"]},unlisted:!1,nextItem:{title:"Deploying Defang with Defang: Part 2",permalink:"/blog/deploying-defang-with-defang-part-2"}},t={authorsImageUrls:[void 0]},d=[{value:"Clone the repo",id:"clone-the-repo",level:2},{value:"Overview of Our Django Application",id:"overview-of-our-django-application",level:2},{value:"Running Locally",id:"running-locally",level:2},{value:"Application Features",id:"application-features",level:2},{value:"Real-time Chat",id:"real-time-chat",level:3},{value:"Background Moderation Tasks",id:"background-moderation-tasks",level:3},{value:"Django Admin",id:"django-admin",level:3},{value:"Deploying with Defang",id:"deploying-with-defang",level:2},{value:"Deploying to Defang Playground",id:"deploying-to-defang-playground",level:3},{value:"Deploying to Your Own Cloud",id:"deploying-to-your-own-cloud",level:3},{value:"Cloud Deployment Results",id:"cloud-deployment-results",level:2},{value:"Why Use Defang?",id:"why-use-defang",level:2},{value:"Try It Yourself",id:"try-it-yourself",level:2}];function c(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("iframe",{style:{width:"100%",aspectRatio:16/9},src:"https://www.youtube.com/embed/edWas0ZIeHI?si=SHD8QYcGLLeuPQ6l",title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",referrerpolicy:"strict-origin-when-cross-origin",allowfullscreen:!0}),"\n",(0,o.jsx)(n.p,{children:"In this guide, we'll walk through the easiest and fastest way to deploy a full-featured Django application\u2014including real-time chat and background task processing\u2014to the cloud using Defang. You'll see firsthand how simple Defang makes it to deploy apps that require multiple services like web servers, background workers, Redis, and Postgres."}),"\n",(0,o.jsx)(n.h2,{id:"clone-the-repo",children:"Clone the repo"}),"\n",(0,o.jsxs)(n.p,{children:["Before we get started, you'll want to clone the repo with the app code, ",(0,o.jsx)(n.a,{href:"https://github.com/DefangLabs/django-chat-demo",children:"here"}),"."]}),"\n",(0,o.jsx)(n.h2,{id:"overview-of-our-django-application",children:"Overview of Our Django Application"}),"\n",(0,o.jsx)(n.p,{children:"We're deploying a real-time chat application that includes automatic moderation powered by a background worker using the Natural Language Toolkit (NLTK). The application structure includes:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Web Service"}),": Django app with chat functionality using Django Channels for real-time interactions."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Worker Service"}),": Background tasks processing messages for profanity and sentiment analysis."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Postgres Database"}),": Managed database instance for persistent storage."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Redis Broker"}),": Managed Redis instance serving as the broker for Celery tasks and Django Channels."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"running-locally",children:"Running Locally"}),"\n",(0,o.jsx)(n.p,{children:"To run the app locally, we use Docker Compose, splitting configurations into two YAML files:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"compose.yaml"}),": Production configuration."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"compose.dev.yaml"}),": Development overrides extending production."]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"You can quickly spin up the application locally with:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"docker compose --env-file .env.dev -f compose.dev.yaml up --build\n"})}),"\n",(0,o.jsxs)(n.p,{children:["This runs things with autoreloading so you can iterate on the Django app, all while passing environment variables in the same way as we will with Defang's ",(0,o.jsx)(n.a,{href:"https://docs.defang.io/docs/concepts/configuration",children:"secure configuration system"})," and being ready to deploy to production."]}),"\n",(0,o.jsx)(n.h2,{id:"application-features",children:"Application Features"}),"\n",(0,o.jsx)(n.h3,{id:"real-time-chat",children:"Real-time Chat"}),"\n",(0,o.jsx)(n.p,{children:"Using Django Channels and Redis, users can engage in real-time conversations within chat rooms."}),"\n",(0,o.jsx)(n.h3,{id:"background-moderation-tasks",children:"Background Moderation Tasks"}),"\n",(0,o.jsx)(n.p,{children:"The worker service runs independently, handling moderation tasks asynchronously. It uses NLTK to:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Check for profanity."}),"\n",(0,o.jsx)(n.li,{children:"Perform sentiment analysis."}),"\n",(0,o.jsx)(n.li,{children:"Automatically flag negative or inappropriate messages."}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["This decouples resource-intensive tasks from the main API server, ensuring optimal application responsiveness. The demo isn't doing anything very complicated, but you could easily run machine learning models ",(0,o.jsx)(n.a,{href:"https://docs.defang.io/docs/tutorials/deploy-with-gpu",children:"with access to GPUs"})," with Defang if you needed to."]}),"\n",(0,o.jsx)(n.h3,{id:"django-admin",children:"Django Admin"}),"\n",(0,o.jsxs)(n.p,{children:["The Django admin is setup to quickly visualize messages and their moderation status. Access it at ",(0,o.jsx)(n.code,{children:"/admin"})," with your superuser credentials: username ",(0,o.jsx)(n.code,{children:"admin"})," and password ",(0,o.jsx)(n.code,{children:"admin"})," setup by default when you first run or deploy."]}),"\n",(0,o.jsx)(n.h2,{id:"deploying-with-defang",children:"Deploying with Defang"}),"\n",(0,o.jsx)(n.p,{children:"Deploying multi-service applications to cloud providers traditionally involves complex infrastructure setup, including configuring ECS clusters, security groups, networking, and more. Defang simplifies this significantly."}),"\n",(0,o.jsx)(n.h3,{id:"deploying-to-defang-playground",children:"Deploying to Defang Playground"}),"\n",(0,o.jsx)(n.p,{children:"The Defang Playground lets you quickly preview your deployed app in a managed environment."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Secure Configuration"})}),"\n",(0,o.jsx)(n.p,{children:"Before deploying, securely set encrypted sensitive values:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"defang config set DJANGO_SECRET_KEY\ndefang config set POSTGRES_PASSWORD\n"})}),"\n",(0,o.jsx)(n.p,{children:"Then run the deployment command:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"defang compose up\n"})}),"\n",(0,o.jsx)(n.p,{children:"Defang automatically:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Builds Docker containers."}),"\n",(0,o.jsx)(n.li,{children:"Sets up required services."}),"\n",(0,o.jsx)(n.li,{children:"Manages networking and provisioning."}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Once deployed, your app is accessible via a public URL provided by Defang, which you can find in the CLI output or in our portal at ",(0,o.jsx)(n.a,{href:"https://portal.defang.io",children:"https://portal.defang.io"})]}),"\n",(0,o.jsx)(n.h3,{id:"deploying-to-your-own-cloud",children:"Deploying to Your Own Cloud"}),"\n",(0,o.jsxs)(n.p,{children:["To deploy directly into your AWS account (or other ",(0,o.jsx)(n.a,{href:"https://docs.defang.io/docs/category/providers",children:"supported providers"}),"):"]}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsx)(n.li,{children:"Set your cloud provider:"}),"\n"]}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["In my case, I use an AWS Profile, but you should be able to use ",(0,o.jsx)(n.a,{href:"https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-configure.html",children:"any methods supported by the AWS CLI"})]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"export DEFANG_PROVIDER=AWS\nexport AWS_PROFILE=your-profile-name\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Secure Configuration"})}),"\n",(0,o.jsx)(n.p,{children:"Before deploying, securely set encrypted sensitive values in your cloud account:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"defang config set DJANGO_SECRET_KEY\ndefang config set POSTGRES_PASSWORD\n"})}),"\n",(0,o.jsxs)(n.ol,{start:"2",children:["\n",(0,o.jsx)(n.li,{children:"Deploy:"}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"defang compose up\n"})}),"\n",(0,o.jsx)(n.p,{children:"Defang handles provisioning managed services (RDS for Postgres, ElastiCache for Redis), container builds, and networking setup. Note: Initial provisioning for managed data stores might take a few minutes."}),"\n",(0,o.jsx)(n.h2,{id:"cloud-deployment-results",children:"Cloud Deployment Results"}),"\n",(0,o.jsx)(n.p,{children:"Post-deployment, your Django app infrastructure includes (among other things):"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Managed Postgres"}),": AWS RDS instance."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Managed Redis"}),": AWS ElastiCache instance."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Containers"}),": ECS services with load balancers and DNS configured."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"why-use-defang",children:"Why Use Defang?"}),"\n",(0,o.jsx)(n.p,{children:"Defang simplifies complex cloud deployments by:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Automatically provisioning managed cloud resources."}),"\n",(0,o.jsx)(n.li,{children:"Securely handling sensitive configurations."}),"\n",(0,o.jsx)(n.li,{children:"Providing seamless container orchestration without manual infrastructure setup."}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"try-it-yourself",children:"Try It Yourself"}),"\n",(0,o.jsxs)(n.p,{children:["Explore deploying your Django applications effortlessly with Defang. The full source code for this example is available on ",(0,o.jsx)(n.a,{href:"https://github.com/DefangLabs/django-chat-demo",children:"GitHub"}),". Feel free to give it a try, and let us know how it goes!"]}),"\n",(0,o.jsx)(n.p,{children:"Happy deploying!"})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>r});var o=i(6540);const s={},a=o.createContext(s);function l(e){const n=o.useContext(a);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),o.createElement(a.Provider,{value:n},e.children)}}}]);