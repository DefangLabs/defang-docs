"use strict";(self.webpackChunkdefang_docs=self.webpackChunkdefang_docs||[]).push([[305],{28453:(e,o,n)=>{n.d(o,{R:()=>d,x:()=>r});var i=n(96540);const t={},s=i.createContext(t);function d(e){const o=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function r(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:d(e.components),i.createElement(s.Provider,{value:o},e.children)}},69048:(e,o,n)=>{n.r(o),n.d(o,{assets:()=>a,contentTitle:()=>r,default:()=>p,frontMatter:()=>d,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"tutorials/updating-your-services","title":"Updating Your Services","description":"How to update services deployed with Defang","source":"@site/docs/tutorials/updating-your-services.md","sourceDirName":"tutorials","slug":"/tutorials/updating-your-services","permalink":"/docs/tutorials/updating-your-services","draft":false,"unlisted":false,"editUrl":"https://github.com/DefangLabs/defang-docs/tree/main/docs/tutorials/updating-your-services.md","tags":[],"version":"current","frontMatter":{"title":"Updating Your Services","description":"How to update services deployed with Defang"},"sidebar":"tutorialsSidebar","previous":{"title":"Setting Up Your GCP Account","permalink":"/docs/tutorials/setting_up_your_gcp_account"},"next":{"title":"How to Use Your Own Domain","permalink":"/docs/tutorials/use-your-own-domain-name"}}');var t=n(74848),s=n(28453);const d={title:"Updating Your Services",description:"How to update services deployed with Defang"},r="Updating Your Services",a={},l=[{value:"Updating a Service",id:"updating-a-service",level:2},{value:"Deploying New Services or Removing Existing Services",id:"deploying-new-services-or-removing-existing-services",level:2},{value:"Deployment Modes",id:"deployment-modes",level:2},{value:"Development Mode (Default)",id:"development-mode-default",level:3},{value:"Production Mode (Zero-downtime Updates)",id:"production-mode-zero-downtime-updates",level:3},{value:"Deleting your Application",id:"deleting-your-application",level:2}];function c(e){const o={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.header,{children:(0,t.jsx)(o.h1,{id:"updating-your-services",children:"Updating Your Services"})}),"\n",(0,t.jsx)(o.p,{children:"This tutorial will show you how to update your services in Defang."}),"\n",(0,t.jsx)(o.h2,{id:"updating-a-service",children:"Updating a Service"}),"\n",(0,t.jsxs)(o.p,{children:["To update your app (for example, updating the base image of your container, or making changes to your code) all you have to do is run the ",(0,t.jsx)(o.code,{children:"defang compose up"})," command and it will build and deploy a new version."]}),"\n",(0,t.jsx)(o.h2,{id:"deploying-new-services-or-removing-existing-services",children:"Deploying New Services or Removing Existing Services"}),"\n",(0,t.jsxs)(o.p,{children:["If you are using ",(0,t.jsx)(o.a,{href:"/docs/concepts/compose",children:"Compose files"})," to define your services, you can add/remove services, make changes to code, etc. When you run ",(0,t.jsx)(o.code,{children:"defang compose up"}),", the update will be diffed against the current state and any necessary changes will be applied to make the current state match the desired state."]}),"\n",(0,t.jsx)(o.h2,{id:"deployment-modes",children:"Deployment Modes"}),"\n",(0,t.jsxs)(o.p,{children:["Defang offers multiple ",(0,t.jsx)(o.a,{href:"/docs/concepts/deployment-modes",children:"deployment modes"}),". You can specify which mode you would like to be used when you deploy with the ",(0,t.jsx)(o.code,{children:"--mode"})," flag on the CLI. The default mode is ",(0,t.jsx)(o.code,{children:"affordable"}),". You may also specify ",(0,t.jsx)(o.code,{children:"balanced"})," or ",(0,t.jsx)(o.code,{children:"high_availability"}),"."]}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-shell",children:"$ defang compose up --mode=production\n"})}),"\n",(0,t.jsx)(o.h3,{id:"development-mode-default",children:"Development Mode (Default)"}),"\n",(0,t.jsxs)(o.p,{children:["The default deployment mode is ",(0,t.jsx)(o.code,{children:"development"}),". This is the In this mode, the existing services will be deprovisioned before your new service will be spun up. This means that there will be a short downtime while the new service is being provisioned."]}),"\n",(0,t.jsx)(o.h3,{id:"production-mode-zero-downtime-updates",children:"Production Mode (Zero-downtime Updates)"}),"\n",(0,t.jsxs)(o.p,{children:["If you are running in ",(0,t.jsx)(o.code,{children:"production"})," mode, the update will be done with zero downtime. Your current version of the service will keep running and handling traffic while the new version is being built and deployed. Only after the new version passes the health checks and accepts traffic will the older version be stopped."]}),"\n",(0,t.jsx)(o.h2,{id:"deleting-your-application",children:"Deleting your Application"}),"\n",(0,t.jsxs)(o.p,{children:["To delete your app, use ",(0,t.jsx)(o.code,{children:"defang compose down"})," in your compose file working directory, or use the ",(0,t.jsx)(o.code,{children:"--project-name"})," flag."]}),"\n",(0,t.jsx)(o.p,{children:"In some cases, particularly on the AWS platform, additional actions may be required. Specifically load balancers may have Deletion Protection on. To turn this off in the AWS Console for EC2 Load Balancers, follow these steps:"}),"\n",(0,t.jsxs)(o.ol,{children:["\n",(0,t.jsx)(o.li,{children:"Select the load balancer corresponding to the app\u2019s name."}),"\n",(0,t.jsx)(o.li,{children:"Go to the Attributes tab."}),"\n",(0,t.jsx)(o.li,{children:"Click the Edit button."}),"\n",(0,t.jsx)(o.li,{children:"Locate Deletion Protection and disable it."}),"\n"]}),"\n",(0,t.jsx)(o.admonition,{type:"info",children:(0,t.jsxs)(o.p,{children:["For more information on Deployment Modes, see the ",(0,t.jsx)(o.a,{href:"/docs/concepts/deployment-modes",children:"Deployment Modes"})," concept documentation."]})})]})}function p(e={}){const{wrapper:o}={...(0,s.R)(),...e.components};return o?(0,t.jsx)(o,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}}}]);