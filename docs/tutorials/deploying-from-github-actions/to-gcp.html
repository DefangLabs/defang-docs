<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-tutorials/deploying-from-github-actions/to-gcp" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">Deploying to GCP | Defang</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.defang.io/img/defang-social-card-2.png"><meta data-rh="true" name="twitter:image" content="https://docs.defang.io/img/defang-social-card-2.png"><meta data-rh="true" property="og:url" content="https://docs.defang.io/docs/tutorials/deploying-from-github-actions/to-gcp"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Deploying to GCP | Defang"><meta data-rh="true" name="description" content="Using the Defang Github Action to deploy your project to GCP from your CI/CD pipeline."><meta data-rh="true" property="og:description" content="Using the Defang Github Action to deploy your project to GCP from your CI/CD pipeline."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.defang.io/docs/tutorials/deploying-from-github-actions/to-gcp"><link data-rh="true" rel="alternate" href="https://docs.defang.io/docs/tutorials/deploying-from-github-actions/to-gcp" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.defang.io/docs/tutorials/deploying-from-github-actions/to-gcp" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://O3VFCOSSZ6-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Tutorials","item":"https://docs.defang.io/docs/category/tutorials"},{"@type":"ListItem","position":2,"name":"Deploying From Github Actions","item":"https://docs.defang.io/docs/category/deploying-from-github-actions"},{"@type":"ListItem","position":3,"name":"Deploying to GCP","item":"https://docs.defang.io/docs/tutorials/deploying-from-github-actions/to-gcp"}]}</script><link rel="search" type="application/opensearchdescription+xml" title="Defang" href="/opensearch.xml">



<link rel="icon" href="/img/tab_icon.svg">
<script src="/analytics.js"></script><link rel="stylesheet" href="/assets/css/styles.0c0bb886.css">
<script src="/assets/js/runtime~main.7353e92d.js" defer="defer"></script>
<script src="/assets/js/main.3e20022c.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://defang.io/" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/defang-logo.svg" alt="Defang Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/defang-logo.svg" alt="Defang Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Defang Home</b></a><a class="navbar__item navbar__link" href="/docs/intro">Docs</a><a href="https://defang.io/blog" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a class="navbar__item navbar__link navbar__item-get_started" href="/docs/getting-started">Get Started</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Meta+k)" aria-keyshortcuts="Meta+k"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 24 24" aria-hidden="true"><circle cx="11" cy="11" r="8" stroke="currentColor" fill="none" stroke-width="1.4"></circle><path d="m21 21-4.3-4.3" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/intro"><span title="Overview" class="categoryLinkLabel_W154">Overview</span></a><button aria-label="Expand sidebar category &#x27;Overview&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/getting-started"><span title="Getting Started" class="linkLabel_WmDU">Getting Started</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/docs/category/tutorials"><span title="Tutorials" class="categoryLinkLabel_W154">Tutorials</span></a><button aria-label="Collapse sidebar category &#x27;Tutorials&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/tutorials/deploy-openai-apps"><span title="Deploy OpenAI Apps on Managed LLMs" class="categoryLinkLabel_W154">Deploy OpenAI Apps on Managed LLMs</span></a><button aria-label="Expand sidebar category &#x27;Deploy OpenAI Apps on Managed LLMs&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/adding-custom-one-click-deploy"><span title="Adding Custom 1-Click Deploy to Your App" class="linkLabel_WmDU">Adding Custom 1-Click Deploy to Your App</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/configure-environment-variables"><span title="Configure Environment Variables" class="linkLabel_WmDU">Configure Environment Variables</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/deploy-container-using-the-cli"><span title="Deploy Existing Containers" class="linkLabel_WmDU">Deploy Existing Containers</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/deploy-to-aws"><span title="Deploy to AWS" class="linkLabel_WmDU">Deploy to AWS</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/deploy-to-digitalocean"><span title="Deploy to DigitalOcean" class="linkLabel_WmDU">Deploy to DigitalOcean</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/deploy-to-gcp"><span title="Deploy to GCP" class="linkLabel_WmDU">Deploy to GCP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/deploy-to-playground"><span title="Deploy to Playground" class="linkLabel_WmDU">Deploy to Playground</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/deploy-to-your-cloud"><span title="Deploy to Your Own Cloud" class="linkLabel_WmDU">Deploy to Your Own Cloud</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/deploy-using-pulumi"><span title="Deploy Using Pulumi" class="linkLabel_WmDU">Deploy Using Pulumi</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/deploy-with-gpu"><span title="Deploy a GPU-Powered Application" class="linkLabel_WmDU">Deploy a GPU-Powered Application</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/category/deploying-from-github-actions"><span title="Deploying From Github Actions" class="categoryLinkLabel_W154">Deploying From Github Actions</span></a><button aria-label="Collapse sidebar category &#x27;Deploying From Github Actions&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/deploying-from-github-actions/to-aws"><span title="Deploying to AWS" class="linkLabel_WmDU">Deploying to AWS</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/tutorials/deploying-from-github-actions/to-gcp"><span title="Deploying to GCP" class="linkLabel_WmDU">Deploying to GCP</span></a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/deploying-from-github-actions"><span title="Deploying from GitHub Actions" class="linkLabel_WmDU">Deploying from GitHub Actions</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/deploying-with-the-defang-mcp-server"><span title="Deploying with the Defang MCP Server" class="linkLabel_WmDU">Deploying with the Defang MCP Server</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/estimating-aws-deployment-costs"><span title="Estimating AWS Deployment Costs" class="linkLabel_WmDU">Estimating AWS Deployment Costs</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/estimating-gcp-deployment-costs"><span title="Estimating GCP Deployment Costs" class="linkLabel_WmDU">Estimating GCP Deployment Costs</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/generate-new-code-using-ai"><span title="Generate Project Outlines With AI" class="linkLabel_WmDU">Generate Project Outlines With AI</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/migrating-from-heroku"><span title="Migrating from Heroku" class="linkLabel_WmDU">Migrating from Heroku</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/monitoring-your-services"><span title="Monitoring Your Services" class="linkLabel_WmDU">Monitoring Your Services</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/scaling-your-services"><span title="Scaling Your Services" class="linkLabel_WmDU">Scaling Your Services</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/setting_up_your_gcp_account"><span title="Setting Up Your GCP Account" class="linkLabel_WmDU">Setting Up Your GCP Account</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/updating-your-services"><span title="Updating Your Services" class="linkLabel_WmDU">Updating Your Services</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/use-your-own-domain-name"><span title="How to Use Your Own Domain" class="linkLabel_WmDU">How to Use Your Own Domain</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/using-codespaces-gitpod"><span title="Using Codespaces and Gitpod" class="linkLabel_WmDU">Using Codespaces and Gitpod</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/using-one-click-deploy"><span title="Using 1-Click Deploy" class="linkLabel_WmDU">Using 1-Click Deploy</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/category/providers"><span title="Providers" class="categoryLinkLabel_W154">Providers</span></a><button aria-label="Expand sidebar category &#x27;Providers&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/category/cli"><span title="CLI" class="categoryLinkLabel_W154">CLI</span></a><button aria-label="Expand sidebar category &#x27;CLI&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/category/concepts"><span title="Concepts" class="categoryLinkLabel_W154">Concepts</span></a><button aria-label="Expand sidebar category &#x27;Concepts&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/category/faq"><span title="FAQ" class="categoryLinkLabel_W154">FAQ</span></a><button aria-label="Expand sidebar category &#x27;FAQ&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/ask"><span title="Ask Defang" class="linkLabel_WmDU">Ask Defang</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item hidden"><a class="menu__link" href="/docs/samples"><span title="Samples" class="linkLabel_WmDU">Samples</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a href="https://defang.io/samples" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_NmtK"><span title="Samples" class="linkLabel_WmDU">Samples</span><svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/category/tutorials"><span>Tutorials</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/category/deploying-from-github-actions"><span>Deploying From Github Actions</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Deploying to GCP</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Deploying to GCP from GitHub Actions</h1></header>
<p>This tutorial will show you how to use the <a href="https://github.com/DefangLabs/defang-github-action" target="_blank" rel="noopener noreferrer">Defang GitHub Action</a> to deploy your project to GCP from your GitHub Actions workflow.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites" translate="no">​</a></h2>
<ul>
<li><a href="/docs/concepts/authentication">A Defang Account</a></li>
<li><a href="https://docs.github.com/en/get-started/quickstart/create-a-repo" target="_blank" rel="noopener noreferrer">A Github Repo</a></li>
<li><a href="https://cloud.google.com" target="_blank" rel="noopener noreferrer">A GCP Account</a></li>
</ul>
<p>The following steps will guide you through setting up a GitHub Actions workflow that can assume a role in your GCP account using OpenID Connect (OIDC) and deploy your project using the Defang GitHub Action. The role which will be assumed must have a trust relationship with an OIDC identity provider (IdP) for GitHub Actions, and that trust relationship must be configured to allow the specific repository and branch to assume the role. This ultimately allows the GitHub Actions workflow to securely access your GCP resources without needing to store long-lived GCP credentials in your repository.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-1---identify-your-gcp-project-id">Step 1 - Identify your GCP Project ID<a href="#step-1---identify-your-gcp-project-id" class="hash-link" aria-label="Direct link to Step 1 - Identify your GCP Project ID" title="Direct link to Step 1 - Identify your GCP Project ID" translate="no">​</a></h2>
<p>To configure the GitHub Action to assume a role in your GCP project, you&#x27;ll need your GCP Project ID.</p>
<div class="theme-tabs-container tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">gcloud CLI</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">GCP Console</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><p>You can list all of the projects you have access to with the following command:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gcloud projects list --format=&quot;value(projectId)&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export PROJECT_ID=&quot;my-project-123456&quot; # export the project ID you want to use</span><br></span></code></pre></div></div><p>Identify the appropriate project ID from the list and keep it handy for the next steps.</p></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><ol>
<li>Go to the <a href="https://console.cloud.google.com/" target="_blank" rel="noopener noreferrer">GCP Console</a>.</li>
<li>Click on the project dropdown in the top navigation bar.</li>
<li>Identify the appropriate project from the list.</li>
<li>Your Project ID will be listed next to the project name.</li>
</ol></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-2---create-a-deployer-service-account">Step 2 - Create a deployer Service Account<a href="#step-2---create-a-deployer-service-account" class="hash-link" aria-label="Direct link to Step 2 - Create a deployer Service Account" title="Direct link to Step 2 - Create a deployer Service Account" translate="no">​</a></h2>
<div class="theme-tabs-container tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">gcloud CLI</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">GCP Console</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><p>Using the gcloud CLI:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gcloud iam service-accounts create &quot;deployer&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --description=&quot;Service account used by Defang for deployment&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --display-name=&quot;Deployer&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --project=&quot;${PROJECT_ID}&quot;</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>Using the GCP Console:</p><ol>
<li>Go to the <a href="https://console.cloud.google.com/iam-admin/serviceaccounts" target="_blank" rel="noopener noreferrer">Service Accounts</a> page in the GCP Console.</li>
<li>Click &quot;Create Service Account&quot; at the top of the page.</li>
<li>For the Service account name, enter &quot;Deployer&quot;</li>
<li>For the Service account ID, enter &quot;deployer&quot;</li>
<li>For the Service account description, enter &quot;Service account used by Defang for deployment&quot;</li>
<li>Click &quot;Create and Continue&quot;</li>
<li>In the &quot;Grant this service account access to the project&quot; section, select the &quot;Owner&quot; role from the dropdown.</li>
<li>Click &quot;Continue&quot;</li>
<li>Click &quot;Done&quot;</li>
</ol></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-2---create-a-workload-identity-pool">Step 2 - Create a Workload Identity Pool<a href="#step-2---create-a-workload-identity-pool" class="hash-link" aria-label="Direct link to Step 2 - Create a Workload Identity Pool" title="Direct link to Step 2 - Create a Workload Identity Pool" translate="no">​</a></h2>
<p>To configure the GitHub Action to assume a role in your GCP account, you&#x27;ll need to create a Workload Identity Pool and a Workload Identity Provider in your GCP project.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>Always add an Attribute Condition to restrict entry into the Workload Identity Pool.</p><p>We recommend replacing <code>YOUR_REPOSITORY_OWNER</code> and <code>YOUR_REPOSITORY_NAME</code> with your actual GitHub repository owner and name in the next step, and adjusting the <code>assertion.ref</code> condition to match your deployment branch. If you want to allow access from any branch, you can omit the <code>assertion.ref</code> condition.</p><p>We also recommend configuring <a href="https://docs.github.com/en/actions/how-tos/deploy/configure-and-manage-deployments/control-deployments#using-environments" target="_blank" rel="noopener noreferrer">GitHub Actions Environments</a>. If you do not configure environments, you can omit the <code>assertion.environment</code> condition below.</p></div></div>
<div class="theme-tabs-container tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">gcloud CLI</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">GCP Console</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><p>Using the gcloud CLI:</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-workload-identity-pool">Create a Workload Identity Pool<a href="#create-a-workload-identity-pool" class="hash-link" aria-label="Direct link to Create a Workload Identity Pool" title="Direct link to Create a Workload Identity Pool" translate="no">​</a></h3><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gcloud iam workload-identity-pools create &quot;defang-github-actions-pool&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --project=&quot;${PROJECT_ID}&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --location=&quot;global&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --display-name=&quot;Defang Github Actions Pool&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --description=&quot;Allow Defang to deploy from Github Actions&quot;</span><br></span></code></pre></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="add-a-workload-identity-provider-to-the-pool">Add a Workload Identity Provider to the Pool<a href="#add-a-workload-identity-provider-to-the-pool" class="hash-link" aria-label="Direct link to Add a Workload Identity Provider to the Pool" title="Direct link to Add a Workload Identity Provider to the Pool" translate="no">​</a></h3><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gcloud iam workload-identity-pools providers create-oidc &quot;defang-github-actions-provider&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --project=&quot;${PROJECT_ID}&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --location=&quot;global&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --workload-identity-pool=&quot;defang-github-actions-pool&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --display-name=&quot;Defang Github Actions Provider&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --issuer-uri=&quot;https://token.actions.githubusercontent.com&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --attribute-mapping=&quot;google.subject=assertion.sub,attribute.actor=assertion.actor,attribute.repository=assertion.repository,attribute.repository_owner=assertion.repository_owner,attribute.environment=assertion.environment,attribute.ref=assertion.ref&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --attribute-condition=&quot;assertion.repository_owner == YOUR_REPOSITORY_OWNER &amp;&amp; assertion.repository == &#x27;YOUR_REPOSITORY_NAME&#x27; &amp;&amp; assertion.ref == &#x27;refs/heads/main&#x27; &amp;&amp; assertion.environment == &#x27;YOUR_ENVIRONMENT&#x27;&quot; \</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>Using the GCP Console:</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-workload-identity-pool-1">Create a Workload Identity Pool<a href="#create-a-workload-identity-pool-1" class="hash-link" aria-label="Direct link to Create a Workload Identity Pool" title="Direct link to Create a Workload Identity Pool" translate="no">​</a></h3><ol>
<li>Go to the <a href="https://console.cloud.google.com/iam-admin/workload-identity-pools" target="_blank" rel="noopener noreferrer">Workload Identity Pools</a> page in the GCP Console.</li>
<li>If you haven&#x27;t created a pool before, click &quot;Get started&quot;, or &quot;Create Pool&quot; if you have.</li>
<li>For the Name field, enter &quot;Defang Github Actions Pool&quot;</li>
<li>For the Pool ID field, enter &quot;defang-github-actions-pool&quot;</li>
<li>For the Description field, enter &quot;Allow Defang to deploy from Github Actions&quot;</li>
<li>Make sure &quot;Enabled pool&quot; is toggled to the &quot;on&quot; position.</li>
<li>Click &quot;Continue&quot;</li>
</ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="add-a-workload-identity-provider">Add a Workload Identity Provider<a href="#add-a-workload-identity-provider" class="hash-link" aria-label="Direct link to Add a Workload Identity Provider" title="Direct link to Add a Workload Identity Provider" translate="no">​</a></h3><ol>
<li>After creating the Workload Identity Pool, you should be on the &quot;Add Provider&quot; page. If not, navigate to the <a href="https://console.cloud.google.com/iam-admin/workload-identity-pools" target="_blank" rel="noopener noreferrer">Workload Identity Pools</a> page, click on the &quot;defang-github-actions-pool&quot;, and then click &quot;Add Provider&quot;.</li>
<li>Select the &quot;OpenID Connect (OIDC)&quot; provider from the &quot;Select a Provider&quot; dropdown.</li>
<li>For the Provider Name field, enter &quot;Defang Github Actions Provider&quot;</li>
<li>For the Provider ID field, enter &quot;defang-github-actions-provider&quot;</li>
<li>For the Issuer URI field, enter <code>https://token.actions.githubusercontent.com</code></li>
<li>You do not need to upload a JSON Web Key Set (JWKS) URI, so leave that field blank.</li>
<li>Use the default audience</li>
<li>Click &quot;Save&quot;</li>
</ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-provider-attributes">Configure Provider Attributes<a href="#configure-provider-attributes" class="hash-link" aria-label="Direct link to Configure Provider Attributes" title="Direct link to Configure Provider Attributes" translate="no">​</a></h3><ol>
<li>For the <code>google.subject</code> attribute, the <code>OIDC 1</code> attribute should be set to <code>assertion.sub</code>.</li>
<li>Add a new attribute mapping for <code>attribute.repository_owner</code> and set it to <code>assertion.repository_owner</code>.</li>
<li>Add a new attribute mapping for <code>attribute.repository</code> and set it to <code>assertion.repository</code>.</li>
<li>Add a new attribute mapping for <code>attribute.environment</code> and set it to <code>assertion.environment</code>.</li>
<li>Add a new attribute mapping for <code>attribute.ref</code> and set it to <code>assertion.ref</code>.</li>
</ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-attribute-conditions">Configure Attribute Conditions<a href="#configure-attribute-conditions" class="hash-link" aria-label="Direct link to Configure Attribute Conditions" title="Direct link to Configure Attribute Conditions" translate="no">​</a></h3><ol>
<li>Click on &quot;Add Condition&quot;</li>
<li>For the Condition CEL, we recommend entering the following condition, replacing <code>YOUR_REPOSITORY_OWNER</code> and <code>YOUR_REPOSITORY_NAME</code> with your actual GitHub repository owner and name.</li>
</ol><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">attribute.repository_owner == &#x27;YOUR_REPOSITORY_OWNER&#x27; &amp;&amp; attribute.repository == &#x27;YOUR_REPOSITORY_NAME&#x27; &amp;&amp; attribute.ref == &#x27;refs/heads/main&#x27;</span><br></span></code></pre></div></div><ol start="3">
<li>Click &quot;Save&quot;</li>
</ol></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-3---grant-your-gcp-service-account-access-to-the-workload-identity-pool">Step 3 - Grant your GCP service account access to the Workload Identity Pool<a href="#step-3---grant-your-gcp-service-account-access-to-the-workload-identity-pool" class="hash-link" aria-label="Direct link to Step 3 - Grant your GCP service account access to the Workload Identity Pool" title="Direct link to Step 3 - Grant your GCP service account access to the Workload Identity Pool" translate="no">​</a></h2>
<div class="theme-tabs-container tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">gcloud CLI</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">GCP Console</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><p>Using the gcloud CLI:</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="get-the-id-of-the-workload-identity-pool-we-just-created">Get the ID of the Workload Identity Pool we just created<a href="#get-the-id-of-the-workload-identity-pool-we-just-created" class="hash-link" aria-label="Direct link to Get the ID of the Workload Identity Pool we just created" title="Direct link to Get the ID of the Workload Identity Pool we just created" translate="no">​</a></h3><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">WORKLOAD_IDENTITY_POOL_ID=$(gcloud iam workload-identity-pools describe &quot;defang-github-actions-pool&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --project=&quot;${PROJECT_ID}&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --location=&quot;global&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --format=&quot;value(name)&quot;) | awk -F/ &#x27;{print $6}&#x27;)</span><br></span></code></pre></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gcloud projects add-iam-policy-binding ${PROJECT_ID} \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --member=&quot;serviceAccount:deployer@${PROJECT_ID}.iam.gserviceaccount.com&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --role=&quot;roles/owner&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --member=&quot;principalSet://iam.googleapis.com/${WORKLOAD_IDENTITY_POOL_ID}/attribute.repository/${REPO}&quot;</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>Using the GCP Console:</p><ol>
<li>Open the GCP Console and navigate to the <a href="https://console.cloud.google.com/iam-admin/workload-identity-pools/pool/defang-github-actions-pool" target="_blank" rel="noopener noreferrer">Workload Identity Pool page for the pool we just created</a>.</li>
<li>Click &quot;Grant access&quot; at the top of the page.</li>
<li>Click &quot;Grant access using service account impersonation&quot;</li>
<li>Select the &quot;Deployer&quot; service account we created earlier.</li>
<li>Select principals:
a. Select <code>repository</code> from the &quot;Attribute name&quot; dropdown.
b. Enter your GitHub repository name in the &quot;Attribute value&quot; field.</li>
<li>Click the &quot;Save&quot; button.</li>
</ol></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-4---create-a-new-github-actions-workflow">Step 4 - Create a new GitHub Actions workflow<a href="#step-4---create-a-new-github-actions-workflow" class="hash-link" aria-label="Direct link to Step 4 - Create a new GitHub Actions workflow" title="Direct link to Step 4 - Create a new GitHub Actions workflow" translate="no">​</a></h2>
<p>In your GitHub repository, create a new file at <code>.github/workflows/deploy.yml</code> with the following content:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Deploy with Defang</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">push</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">branches</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> main  </span><span class="token comment" style="color:#999988;font-style:italic"># Change this to your default branch if it&#x27;s not &#x27;main&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">deploy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">runs-on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">permissions</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">contents</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> read</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">id-token</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> write</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">env</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">GCP_PROJECT_ID</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Provide your GCP Project ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Configure GCP Credentials for Prod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;google-github-actions/auth@v2&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">with</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">service_account</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;deployer@${{ env.GCP_PROJECT_ID }}.iam.gserviceaccount.com&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">workload_identity_provider</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;projects/${{ env.GCP_PROJECT_ID }}/locations/global/workloadIdentityPools/defang-github-actions-pool/providers/defang-github-actions-provider&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">token_format</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> access_token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">access_token_scopes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> https</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//www.googleapis.com/auth/cloud</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">platform</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Checkout Repo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> actions/checkout@v4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Deploy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> DefangLabs/defang</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">github</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">action@v1.2.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">with</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mode</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;balanced&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">provider</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;gcp&quot;</span><br></span></code></pre></div></div>
<p>Full documentation for configuring AWS and GCP credentials can be found in the <a href="https://github.com/DefangLabs/defang-github-action" target="_blank" rel="noopener noreferrer">Defang GitHub Action repository</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/DefangLabs/defang-docs/tree/main/docs/tutorials/deploying-from-github-actions/to-gcp.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/tutorials/deploying-from-github-actions/to-aws"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Deploying to AWS</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/tutorials/deploying-from-github-actions"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Deploying from GitHub Actions</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#step-1---identify-your-gcp-project-id" class="table-of-contents__link toc-highlight">Step 1 - Identify your GCP Project ID</a></li><li><a href="#step-2---create-a-deployer-service-account" class="table-of-contents__link toc-highlight">Step 2 - Create a deployer Service Account</a></li><li><a href="#step-2---create-a-workload-identity-pool" class="table-of-contents__link toc-highlight">Step 2 - Create a Workload Identity Pool</a><ul><li><a href="#create-a-workload-identity-pool" class="table-of-contents__link toc-highlight">Create a Workload Identity Pool</a></li><li><a href="#add-a-workload-identity-provider-to-the-pool" class="table-of-contents__link toc-highlight">Add a Workload Identity Provider to the Pool</a></li><li><a href="#create-a-workload-identity-pool-1" class="table-of-contents__link toc-highlight">Create a Workload Identity Pool</a></li><li><a href="#add-a-workload-identity-provider" class="table-of-contents__link toc-highlight">Add a Workload Identity Provider</a></li><li><a href="#configure-provider-attributes" class="table-of-contents__link toc-highlight">Configure Provider Attributes</a></li><li><a href="#configure-attribute-conditions" class="table-of-contents__link toc-highlight">Configure Attribute Conditions</a></li></ul></li><li><a href="#step-3---grant-your-gcp-service-account-access-to-the-workload-identity-pool" class="table-of-contents__link toc-highlight">Step 3 - Grant your GCP service account access to the Workload Identity Pool</a><ul><li><a href="#get-the-id-of-the-workload-identity-pool-we-just-created" class="table-of-contents__link toc-highlight">Get the ID of the Workload Identity Pool we just created</a></li></ul></li><li><a href="#step-4---create-a-new-github-actions-workflow" class="table-of-contents__link toc-highlight">Step 4 - Create a new GitHub Actions workflow</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Sections</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/category/tutorials">Tutorials</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/category/providers">Providers</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/category/cli">CLI Reference</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/category/concepts">Concepts</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://defang.io/blog" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/ask">Ask Defang</a></li><li class="footer__item"><a href="https://defang.io/samples" target="_blank" rel="noopener noreferrer" class="footer__link-item">Samples<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/DefangLabs" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://s.defang.io/discord" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://twitter.com/DefangLabs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/defang/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/@DefangLabs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div></div></footer></div>
</body>
</html>