<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">Sample: Starter Kit for RAG + Agents with CrewAI | Defang</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.defang.io/img/defang-social-card-2.png"><meta data-rh="true" name="twitter:image" content="https://docs.defang.io/img/defang-social-card-2.png"><meta data-rh="true" property="og:url" content="https://docs.defang.io/blog/2025/06/16/crew-ai-sample"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Sample: Starter Kit for RAG + Agents with CrewAI | Defang"><meta data-rh="true" name="description" content="Going over our sample for RAG + Agents with CrewAI"><meta data-rh="true" property="og:description" content="Going over our sample for RAG + Agents with CrewAI"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2025-06-16T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://defang.io"><meta data-rh="true" property="article:tag" content="Cloud,NoDevOps,Docker Compose,Defang,Sample"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.defang.io/blog/2025/06/16/crew-ai-sample"><link data-rh="true" rel="alternate" href="https://docs.defang.io/blog/2025/06/16/crew-ai-sample" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.defang.io/blog/2025/06/16/crew-ai-sample" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://O3VFCOSSZ6-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://docs.defang.io/blog/2025/06/16/crew-ai-sample","mainEntityOfPage":"https://docs.defang.io/blog/2025/06/16/crew-ai-sample","url":"https://docs.defang.io/blog/2025/06/16/crew-ai-sample","headline":"Sample: Starter Kit for RAG + Agents with CrewAI","name":"Sample: Starter Kit for RAG + Agents with CrewAI","description":"Going over our sample for RAG + Agents with CrewAI","datePublished":"2025-06-16T00:00:00.000Z","author":{"@type":"Person","name":"Defang Team","description":"Defang Team","url":"https://defang.io","image":"/img/defang-logo.svg"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://docs.defang.io/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Defang RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Defang Atom Feed">




<link rel="search" type="application/opensearchdescription+xml" title="Defang" href="/opensearch.xml">



<link rel="icon" href="/img/tab_icon.svg">
<script src="/analytics.js"></script><link rel="stylesheet" href="/assets/css/styles.d4cba568.css">
<script src="/assets/js/runtime~main.71d44282.js" defer="defer"></script>
<script src="/assets/js/main.3d5530e4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://defang.io/" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/defang-logo.svg" alt="Defang Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/defang-logo.svg" alt="Defang Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Defang Home</b></a><a class="navbar__item navbar__link" href="/docs/intro">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a class="navbar__item navbar__link navbar__item-get_started" href="/docs/getting-started">Get Started</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Meta+k)" aria-keyshortcuts="Meta+k"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 24 24" aria-hidden="true"><circle cx="11" cy="11" r="8" stroke="currentColor" fill="none" stroke-width="1.4"></circle><path d="m21 21-4.3-4.3" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All Posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/heroku-to-aws">Beyond Heroku: Owning Your Deployments</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/agentic-era">Deployments in the Agentic Era</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025-09-09-product-update">August 2025 Defang Compose Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/agentic-apps">Deploying Agentic Apps to the Cloud Shouldn‚Äôt Be This Hard‚Ä¶</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025-08-12-product-update">July 2025 Defang Compose Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/defang-your-ai-devops-agent">Defang: Your AI DevOps Agent</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/defang-gcp-compose">Simple, Secure, and Scalable GCP Deployments from Docker Compose</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025-07-10-product-update">June 2025 Defang Compose Update</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/2025/06/16/crew-ai-sample">Sample: Starter Kit for RAG + Agents with CrewAI</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025/06/16/docker-compose-defang">Bridging Local Development and Cloud Deployment</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025/06/06/may-product-updates">May 2025 Defang Compose Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025/05/09/april-product-updates">April 2025 Defang Compose Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025/04/23/vibe-deploy">Welcome to the world of &quot;Vibe Deploy&quot;: Easily Deploying your Vibe Coding Projects to the Cloud with Defang</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025/04/11/mar-product-updates">March 2025 Defang Compose Update </a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025/04/10/easiest-way-to-deploy-django">Deploying a Django App with Real-time Moderation Using Defang</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025/03/26/deploying-defang-with-defang-part-2">Deploying Defang with Defang: Part 2</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025/03/15/feb-product-updates">February 2025 Defang Compose Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025/03/14/deploying-defang-with-defang-part-1">Deploying Defang with Defang: Part 1</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025/03/12/website-logo-refresh-announcement">Introducing Defang&#x27;s New Look: Website &amp; Logo Refresh</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025/02/18/model-context-protocol">Simplifying Deployment of AI Apps to the Cloud using Docker and Model Context Protocol</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025/02/07/january-product-updates">January 2025 Defang Compose Update</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/12/11/product-hunt">Defang is live on Product Hunt!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/12/04/launch-week">üöÄ Defang V1: Launch Week is Here!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/11/13/october-product-updates">October 2024 Defang Compose Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/11/12/hard-lessons-from-hardware">Hard Lessons From Hardware</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/09/30/september-product-updates">September 2024 Defang Compose Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/08/30/august-product-updates">August 2024 Defang Compose Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/07/31/july-product-updates-2">July 2024 Defang Compose Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/07/01/july-product-updates">June 2024 Defang Compose Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/06/01/june-product-updates">May 2024 Defang Compose Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/05/01/may-product-updates">April 2024 Defang Compose Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/03/28/slackbot-sample">Deploy a Go-powered slackbot with Defang</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/03/20/dev-environments">Add Defang to your developer environments instantly</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/03/04/about-my-journey-deploying-my-first-web-application">About my Journey Deploying my First Web Application</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/02/12/announcing-defang-public-beta">Announcing the Defang Public Beta</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2023</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/06/29/Announcing-the-Private-Beta-for-the-DOP">Announcing the Private Beta for the Defang Opinionated Platform</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">Sample: Starter Kit for RAG + Agents with CrewAI</h1><div class="container_mt6G margin-vert--md"><time datetime="2025-06-16T00:00:00.000Z">June 16, 2025</time> ¬∑ <!-- -->7 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://defang.io" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="/img/defang-logo.svg" alt="Defang Team"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://defang.io" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp" translate="no">Defang Team</span></a></div><small class="authorTitle_nd0D" title="Defang Team">Defang Team</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="why-build-a-starter-kit-for-rag--agents">Why Build a Starter Kit for RAG + Agents?<a href="#why-build-a-starter-kit-for-rag--agents" class="hash-link" aria-label="Direct link to Why Build a Starter Kit for RAG + Agents?" title="Direct link to Why Build a Starter Kit for RAG + Agents?" translate="no">‚Äã</a></h2>
<p>Let‚Äôs be honest: every developer who‚Äôs played with LLMs gets that rush of ‚Äúwow‚Äù from the first working demo. But the real headaches show up when you need to stitch LLMs into something production-grade: an app that can pull in real data, coordinate multi-step logic, and more. Suddenly, you‚Äôre not just writing single prompts. You‚Äôre coordinating between multiple prompts, managing queues, adding vector databases, orchestrating workers, and trying to get things back to the user in real-time. We&#x27;ve found that <a href="https://www.crewai.com/" target="_blank" rel="noopener noreferrer">CrewAI</a> (coordinating prompts, agents, tools) + <a href="https://www.djangoproject.com/" target="_blank" rel="noopener noreferrer">Django</a> (building an api, managing data), with a bit of <a href="https://docs.celeryproject.org/en/stable/" target="_blank" rel="noopener noreferrer">Celery</a> (orchestrating workers/async tasks), is a really nice set of tools for this. We&#x27;re also going to use <a href="https://channels.readthedocs.io/en/stable/" target="_blank" rel="noopener noreferrer">Django Channels</a> (real-time updates) to push updates back to the user. And of course, we&#x27;ll use <a href="https://www.defang.io/" target="_blank" rel="noopener noreferrer">Defang</a> to deploy all that to the cloud.</p>
<p>If this sounds familiar (or if you&#x27;re dreading the prospect of dealing with it), you‚Äôre the target audience for this sample. Instead of slogging through weeks of configuration and permissions hell, you get a ready-made template that runs on your laptop, then scales‚Äîunchanged‚Äîto Defang‚Äôs Playground, and finally to your own AWS or GCP account. All the gnarly infra is abstracted, so you can focus on getting as much value as possible out of that magical combo of CrewAI and Django.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Just want the sample?</div><div class="admonitionContent_BuS1"><p>You can <a href="https://github.com/DefangSamples/sample-crew-django-redis-postgres-template" target="_blank" rel="noopener noreferrer">find it here</a>.</p></div></div>
<!-- -->
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="a-demo-in-60-seconds">A Demo in 60 Seconds<a href="#a-demo-in-60-seconds" class="hash-link" aria-label="Direct link to A Demo in 60 Seconds" title="Direct link to A Demo in 60 Seconds" translate="no">‚Äã</a></h2>
<p>Imagine you&#x27;re building a system. It might use multiple LLM calls. It might do complex, branching logic in its prompts. It might need to store embeddings to retrieve things in the future, either to pull them into a prompt, or to return them outright. It might need to store other records that don&#x27;t have embeddings. Here&#x27;s a very lightweight version of a system like that, as a starting point:</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/0YlDcUSfdcc?si=afue_MwrWs2-ZNBV" title="Quick Demo" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin"></iframe>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="architecture-at-a-glance">Architecture at a Glance<a href="#architecture-at-a-glance" class="hash-link" aria-label="Direct link to Architecture at a Glance" title="Direct link to Architecture at a Glance" translate="no">‚Äã</a></h2>
<p>Behind the scenes, the workflow is clean and powerful. The browser connects via <a href="https://channels.readthedocs.io/en/latest/deploying.html#http-and-websocket" target="_blank" rel="noopener noreferrer">WebSockets to our app using Django Channels</a>. Heavy work is pushed to a <a href="https://docs.celeryq.dev/en/stable/" target="_blank" rel="noopener noreferrer">Celery worker</a>. That worker generates an <a href="https://en.wikipedia.org/wiki/Embedding_(machine_learning)" target="_blank" rel="noopener noreferrer">embedding</a>, checks <a href="https://www.postgresql.org/" target="_blank" rel="noopener noreferrer">Postgres</a> with <a href="https://github.com/pgvector/pgvector" target="_blank" rel="noopener noreferrer">pgvector</a> for a match, and either returns the summary or, if there‚Äôs no hit, fires up a <a href="https://www.crewai.com/" target="_blank" rel="noopener noreferrer">CrewAI agent</a> to generate one. Every update streams back through <a href="https://redis.io/" target="_blank" rel="noopener noreferrer">Redis</a> and Django Channels so users get progress in real time.</p>
<img src="/img/crew-ai-sample/arch.png" alt="Architecture" style="box-shadow:none;border-radius:0;width:100%;max-width:650px;height:auto">
<p>Durable state lives in Postgres and Redis. Model services (<a href="https://en.wikipedia.org/wiki/LLM" target="_blank" rel="noopener noreferrer">LLMs</a> and embeddings) are fully swappable, so you can upgrade to different models in the cloud or localize with the <a href="https://docs.docker.com/compose/how-tos/model-runner/" target="_blank" rel="noopener noreferrer">Docker Model Runner</a> without rewriting the full stack.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="under-the-hood-the-services">Under the Hood: The Services<a href="#under-the-hood-the-services" class="hash-link" aria-label="Direct link to Under the Hood: The Services" title="Direct link to Under the Hood: The Services" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="django--channels">Django + Channels<a href="#django--channels" class="hash-link" aria-label="Direct link to Django + Channels" title="Direct link to Django + Channels" translate="no">‚Äã</a></h3>
<p>The Django app is the front door, routing HTTP and WebSocket traffic, serving up the admin, and delivering static content. It‚Äôs built on <a href="https://github.com/django/daphne" target="_blank" rel="noopener noreferrer">Daphne</a> and Django Channels, with Redis as the channel layer for real-time group events. Django‚Äôs admin is your friend here: to start you can check what summaries exist, but if you start building out your own app, it&#x27;ll make it a breeze to debug and manage your system.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="postgresql--pgvector">PostgreSQL + pgvector<a href="#postgresql--pgvector" class="hash-link" aria-label="Direct link to PostgreSQL + pgvector" title="Direct link to PostgreSQL + pgvector" translate="no">‚Äã</a></h3>
<p>This is where your data lives. Summaries and their 1024-dimension embeddings go here. A simple SQL query checks for close matches by cosine distance, and pgvector‚Äôs index keeps search blazing fast. In BYOC (bring-your-own-cloud) mode, flip a single flag and Defang provisions you a production-grade RDS instance.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="redis">Redis<a href="#redis" class="hash-link" aria-label="Direct link to Redis" title="Direct link to Redis" translate="no">‚Äã</a></h3>
<p>Redis is doing triple duty: as the message broker and result backend for Celery, and as the channel layer for real-time WebSocket updates. The pub/sub system lets a single worker update all browser tabs listening to the same group. And if you want to scale up, swap a flag and Defang will run managed ElastiCache in production. No code change required.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="celery-worker">Celery Worker<a href="#celery-worker" class="hash-link" aria-label="Direct link to Celery Worker" title="Direct link to Celery Worker" translate="no">‚Äã</a></h3>
<p>The Celery worker is where the magic happens. It takes requests off the queue, generates embeddings, checks for similar summaries, and‚Äîif necessary‚Äîinvokes a CrewAI agent to get a new summary. It then persists summaries and pushes progress updates back to the user.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="llm-and-embedding-services">LLM and Embedding Services<a href="#llm-and-embedding-services" class="hash-link" aria-label="Direct link to LLM and Embedding Services" title="Direct link to LLM and Embedding Services" translate="no">‚Äã</a></h3>
<p>Thanks to Docker Model Runner, the LLM and embedding services run as containerized, OpenAI-compatible HTTP endpoints. Want to switch to a different model? Change a single line in your compose file. Environment variables like <code>LLM_URL</code> and <code>EMBEDDING_MODEL</code> are injected for you‚Äîno secret sharing or hard-coding required.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="crewai-workflows">CrewAI Workflows<a href="#crewai-workflows" class="hash-link" aria-label="Direct link to CrewAI Workflows" title="Direct link to CrewAI Workflows" translate="no">‚Äã</a></h3>
<p>With CrewAI, your agent logic is declarative and pluggable. This sample keeps it simple‚Äîa single summarization agent‚Äîbut you can add classification, tool-calling, or chain-of-thought logic without rewriting your task runner.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-the-compose-files-work">How the Compose Files Work<a href="#how-the-compose-files-work" class="hash-link" aria-label="Direct link to How the Compose Files Work" title="Direct link to How the Compose Files Work" translate="no">‚Äã</a></h2>
<p>In local dev, your <code>compose.local.yaml</code> spins up <a href="https://hub.docker.com/r/ai/gemma3" target="_blank" rel="noopener noreferrer">Gemma</a> and <a href="https://hub.docker.com/r/ai/mxbai-embed-large" target="_blank" rel="noopener noreferrer">Mixedbread</a> models, running fully locally and with no cloud credentials or API keys required. URLs for service-to-service communication are injected at runtime. When you‚Äôre ready to deploy, swap in the main <code>compose.yaml</code> which adds Defang‚Äôs <code>x-defang-llm</code>, <code>x-defang-redis</code>, and <code>x-defang-postgres</code> flags. Now, Defang maps your Compose intent to real infrastructure‚Äîmanaged model endpoints, Redis, and Postgres‚Äîon cloud providers like AWS or GCP. It handles all networking, secrets, and service discovery for you. There‚Äôs no YAML rewriting or ‚Äúdev vs prod‚Äù drift.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-three-step-deployment-journey">The Three-Step Deployment Journey<a href="#the-three-step-deployment-journey" class="hash-link" aria-label="Direct link to The Three-Step Deployment Journey" title="Direct link to The Three-Step Deployment Journey" translate="no">‚Äã</a></h2>
<p>You can run everything on your laptop with a single <code>docker compose -f ./compose.local.yaml up</code> command‚Äîno cloud dependencies, fast iteration, and no risk of cloud charges. When you‚Äôre ready for the next step, use <code>defang compose up</code> to push to the Defang Playground. This free hosted sandbox is perfect for trying Defang, demos, or prototyping. It automatically adds TLS to your endpoints and sleeps after a week. For production, use your own AWS or GCP account. <code>DEFANG_PROVIDER=aws defang compose up</code> maps each service to a managed equivalent (ECS, RDS, ElastiCache, Bedrock models), wires up secrets, networking, etc. Your infra. Your data.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="some-best-practices-and-design-choices">Some Best Practices and Design Choices<a href="#some-best-practices-and-design-choices" class="hash-link" aria-label="Direct link to Some Best Practices and Design Choices" title="Direct link to Some Best Practices and Design Choices" translate="no">‚Äã</a></h2>
<p>This sample uses vector similarity to try and fetch summaries that are semantically similar to the input. For more robust results, you might want to embed the original input. You can also think about chunking up longer content for finer-grained matches that you can integrate in your CrewAI workflows. Real-time progress via Django Channels beats HTTP polling, especially for LLM tasks that can take a while. The app service is stateless, which means you can scale it horizontally just by adding more containers which is easy to specify in your compose file.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="going-further-extending-the-sample">Going Further: Extending the Sample<a href="#going-further-extending-the-sample" class="hash-link" aria-label="Direct link to Going Further: Extending the Sample" title="Direct link to Going Further: Extending the Sample" translate="no">‚Äã</a></h2>
<p>You‚Äôre not limited to a single summarization agent. CrewAI makes it trivial to add multi-agent flows (classification, tool use, knowledge retrieval). For big docs, chunk-level embeddings allow granular retrieval. You can wire in tool-calling to connect with external APIs or databases. You can integrate more deeply with Django&#x27;s ORM and the PGVector tooling that we demo&#x27;d in the sample to build more complex agents that actually use RAG.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ready-to-build">Ready to Build?<a href="#ready-to-build" class="hash-link" aria-label="Direct link to Ready to Build?" title="Direct link to Ready to Build?" translate="no">‚Äã</a></h2>
<p>With this sample, you‚Äôve got an agent-ready, RAG-ready backend that runs anywhere, with no stacks of YAML or vendor lock-in. Fork it, extend it, productionize it: scale up, add more agents, or swap in different models, or more models!</p>
<p>Quickstart:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker compose -f compose.local.yaml up --build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Playground</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">defang compose up</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># BYOC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Setup credentials and then swap &lt;provider&gt; with aws or gcp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DEFANG_PROVIDER=&lt;provider&gt; defang compose up</span><br></span></code></pre></div></div>
<p>Want more? File an <a href="https://github.com/DefangLabs/samples/issues" target="_blank" rel="noopener noreferrer">issue</a> to request a sample‚Äîwe&#x27;ll do everything we can to help you deploy better and faster!</p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/cloud">Cloud</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/no-dev-ops">NoDevOps</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/docker-compose">Docker Compose</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/defang">Defang</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/sample">Sample</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/2025-07-10-product-update"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">June 2025 Defang Compose Update</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/2025/06/16/docker-compose-defang"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">Bridging Local Development and Cloud Deployment</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#why-build-a-starter-kit-for-rag--agents" class="table-of-contents__link toc-highlight">Why Build a Starter Kit for RAG + Agents?</a></li><li><a href="#a-demo-in-60-seconds" class="table-of-contents__link toc-highlight">A Demo in 60 Seconds</a></li><li><a href="#architecture-at-a-glance" class="table-of-contents__link toc-highlight">Architecture at a Glance</a></li><li><a href="#under-the-hood-the-services" class="table-of-contents__link toc-highlight">Under the Hood: The Services</a><ul><li><a href="#django--channels" class="table-of-contents__link toc-highlight">Django + Channels</a></li><li><a href="#postgresql--pgvector" class="table-of-contents__link toc-highlight">PostgreSQL + pgvector</a></li><li><a href="#redis" class="table-of-contents__link toc-highlight">Redis</a></li><li><a href="#celery-worker" class="table-of-contents__link toc-highlight">Celery Worker</a></li><li><a href="#llm-and-embedding-services" class="table-of-contents__link toc-highlight">LLM and Embedding Services</a></li><li><a href="#crewai-workflows" class="table-of-contents__link toc-highlight">CrewAI Workflows</a></li></ul></li><li><a href="#how-the-compose-files-work" class="table-of-contents__link toc-highlight">How the Compose Files Work</a></li><li><a href="#the-three-step-deployment-journey" class="table-of-contents__link toc-highlight">The Three-Step Deployment Journey</a></li><li><a href="#some-best-practices-and-design-choices" class="table-of-contents__link toc-highlight">Some Best Practices and Design Choices</a></li><li><a href="#going-further-extending-the-sample" class="table-of-contents__link toc-highlight">Going Further: Extending the Sample</a></li><li><a href="#ready-to-build" class="table-of-contents__link toc-highlight">Ready to Build?</a></li></ul></div></div></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Sections</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/category/tutorials">Tutorials</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/category/providers">Providers</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/category/cli">CLI Reference</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/category/concepts">Concepts</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/ask">Ask Defang</a></li><li class="footer__item"><a href="https://defang.io/samples" target="_blank" rel="noopener noreferrer" class="footer__link-item">Samples<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/DefangLabs" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://s.defang.io/discord" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://twitter.com/DefangLabs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/defang/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/@DefangLabs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div></div></footer></div>
</body>
</html>